{
    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
    "contentVersion": "1.0.0.0",
    "parameters": {
        "location": {
            "type": "string",
            "defaultValue": "" 
        },
        "workspace": {
            "type": "string",
            "allowedValues": [
				"eastus",
				"westeurope",
				"southeastasia",
				"australiasoutheast",
				"westcentralus",
				"japaneast"
			],
		"defaultValue": "westeurope",
        }
    },
	"variables": {
        "workspaceapiversion": "2017-03-15-preview"
    },
    "resources": [
        {
            "apiVersion": "[variables('workspaceapiversion')]",
            "name": "[parameters('workspace')]",
            "type": "Microsoft.OperationalInsights/workspaces",
            "location": "[parameters('location')]",
            "properties": {"sku": {"Name": "Standalone"},"retentionInDays": 360},
            
            "id": "[Concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.OperationalInsights/workspaces/', parameters('workspace'))]",
            
          "resources": [
{
    "apiVersion":  "2015-11-01-preview",
    "name":  "Citrix Processes",
    "type":  "views",
    "location":  "[parameters('location')]",
    "id":  "[Concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.OperationalInsights/workspaces/', parameters('workspace'),'/views/Citrix Processes')]",
    "dependson":  [
                      "[Concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.OperationalInsights/workspaces/', parameters('workspace'))]"
                  ],
    "properties":  {
                       "Id":  "Citrix Processes",
                       "Name":  "Citrix Processes",
                       "Author":  "marcel.meurer@sepago.de",
                       "Source":  "Local",
                       "Version":  2,
                       "Dashboard":  [
                                         {
                                             "Id":  "LineChartCalloutBuilderBlade",
                                             "Type":  "Blade",
                                             "Version":  0,
                                             "Configuration":  {
                                                                   "General":  {
                                                                                   "title":  "Reported Processes",
                                                                                   "newGroup":  false,
                                                                                   "icon":  "",
                                                                                   "useIcon":  false
                                                                               },
                                                                   "Header":  {
                                                                                  "Title":  "Processes by Worker",
                                                                                  "Subtitle":  "count"
                                                                              },
                                                                   "LineChart":  {
                                                                                     "Query":  "ITPC_CTX_Process_CL | summarize AggregatedValue = dcount(NameInSession_s) by Worker_s// Oql: Type=ITPC_CTX_Process_CL | measure countdistinct(NameInSession_s) by Worker_s",
                                                                                     "Callout":  {
                                                                                                     "Title":  "Avg",
                                                                                                     "Series":  "",
                                                                                                     "Operation":  "Average"
                                                                                                 },
                                                                                     "yAxis":  {
                                                                                                   "isLogarithmic":  false,
                                                                                                   "units":  {
                                                                                                                 "baseUnitType":  "",
                                                                                                                 "baseUnit":  "",
                                                                                                                 "displayUnit":  ""
                                                                                                             },
                                                                                                   "customLabel":  ""
                                                                                               },
                                                                                     "NavigationSelect":  {

                                                                                                          }
                                                                                 },
                                                                   "List":  {
                                                                                "Query":  "ITPC_CTX_Process_CL | summarize AggregatedValue = dcount(NameInSession_s) by Worker_s | sort by Worker_s asc// Oql: Type=ITPC_CTX_Process_CL | measure countdistinct(NameInSession_s) by Worker_s | sort Worker_s",
                                                                                "HideGraph":  false,
                                                                                "enableSparklines":  true,
                                                                                "ColumnsTitle":  {
                                                                                                     "Name":  "Worker",
                                                                                                     "Value":  "Count"
                                                                                                 },
                                                                                "Color":  "#0072c6",
                                                                                "thresholds":  {
                                                                                                   "isEnabled":  false,
                                                                                                   "values":  [
                                                                                                                  {
                                                                                                                      "name":  "Normal",
                                                                                                                      "threshold":  "Default",
                                                                                                                      "color":  "#009e49",
                                                                                                                      "isDefault":  true
                                                                                                                  },
                                                                                                                  {
                                                                                                                      "name":  "Warning",
                                                                                                                      "threshold":  "60",
                                                                                                                      "color":  "#fcd116",
                                                                                                                      "isDefault":  false
                                                                                                                  },
                                                                                                                  {
                                                                                                                      "name":  "Error",
                                                                                                                      "threshold":  "90",
                                                                                                                      "color":  "#ba141a",
                                                                                                                      "isDefault":  false
                                                                                                                  }
                                                                                                              ]
                                                                                               },
                                                                                "NameDSVSeparator":  "",
                                                                                "NavigationQuery":  "search {selected item} | sort by TimeGenerated desc",
                                                                                "NavigationSelect":  {
                                                                                                         "NavigationQuery":  "search {selected item} | sort by TimeGenerated desc"
                                                                                                     }
                                                                            }
                                                               }
                                         },
                                         {
                                             "Id":  "LineChartCalloutBuilderBlade",
                                             "Type":  "Blade",
                                             "Version":  0,
                                             "Configuration":  {
                                                                   "General":  {
                                                                                   "title":  "Process CPU Consumption (Avg)",
                                                                                   "newGroup":  true,
                                                                                   "icon":  "",
                                                                                   "useIcon":  false
                                                                               },
                                                                   "Header":  {
                                                                                  "Title":  "Overall by Process Name",
                                                                                  "Subtitle":  "% CPU"
                                                                              },
                                                                   "LineChart":  {
                                                                                     "Query":  "ITPC_CTX_Process_CL | where Name_s != \"System Idle Process\" | summarize AggregatedValue = avg(PercentProcessorTime_d) by Name_s\r\n// Oql: Type=ITPC_CTX_Process_CL not Name_s:\"System Idle Process\"  |measure avg(PercentProcessorTime_d) by Name_s",
                                                                                     "Callout":  {
                                                                                                     "Title":  "Avg",
                                                                                                     "Series":  "",
                                                                                                     "Operation":  "Last Sample"
                                                                                                 },
                                                                                     "yAxis":  {
                                                                                                   "isLogarithmic":  false,
                                                                                                   "units":  {
                                                                                                                 "baseUnitType":  "",
                                                                                                                 "baseUnit":  "",
                                                                                                                 "displayUnit":  ""
                                                                                                             },
                                                                                                   "customLabel":  ""
                                                                                               },
                                                                                     "NavigationSelect":  {

                                                                                                          }
                                                                                 },
                                                                   "List":  {
                                                                                "Query":  "ITPC_CTX_Process_CL | where Name_s != \"System Idle Process\" | summarize AggregatedValue = avg(PercentProcessorTime_d) by Name_s\r\n// Oql: Type=ITPC_CTX_Process_CL not Name_s:\"System Idle Process\"  |measure avg(PercentProcessorTime_d) by Name_s",
                                                                                "HideGraph":  false,
                                                                                "enableSparklines":  true,
                                                                                "operation":  "Summary",
                                                                                "ColumnsTitle":  {
                                                                                                     "Name":  "Name",
                                                                                                     "Value":  "Count"
                                                                                                 },
                                                                                "Color":  "#0072c6",
                                                                                "thresholds":  {
                                                                                                   "isEnabled":  false,
                                                                                                   "values":  [
                                                                                                                  {
                                                                                                                      "name":  "Normal",
                                                                                                                      "threshold":  "Default",
                                                                                                                      "color":  "#009e49",
                                                                                                                      "isDefault":  true
                                                                                                                  },
                                                                                                                  {
                                                                                                                      "name":  "Warning",
                                                                                                                      "threshold":  "60",
                                                                                                                      "color":  "#fcd116",
                                                                                                                      "isDefault":  false
                                                                                                                  },
                                                                                                                  {
                                                                                                                      "name":  "Error",
                                                                                                                      "threshold":  "90",
                                                                                                                      "color":  "#ba141a",
                                                                                                                      "isDefault":  false
                                                                                                                  }
                                                                                                              ]
                                                                                               },
                                                                                "NameDSVSeparator":  "",
                                                                                "NavigationQuery":  "search in (ITPC_CTX_Process_CL) {selected item} | summarize CPU_Perc = avg(PercentProcessorTime_d) by UserName_s, Worker_s, bin(TimeGenerated, 1h) | sort by TimeGenerated desc | render timechart\r\n// Oql: {selected item} Type=ITPC_CTX_Process_CL | measure avg(PercentProcessorTime_d) as CPU_Perc by UserName_s,Worker_s | display LineChart",
                                                                                "NavigationSelect":  {

                                                                                                     }
                                                                            }
                                                               }
                                         },
                                         {
                                             "Id":  "LineChartCalloutBuilderBlade",
                                             "Type":  "Blade",
                                             "Version":  0,
                                             "Configuration":  {
                                                                   "General":  {
                                                                                   "title":  "Process CPU Consumption (Max)",
                                                                                   "newGroup":  false,
                                                                                   "icon":  "",
                                                                                   "useIcon":  false
                                                                               },
                                                                   "Header":  {
                                                                                  "Title":  "Overall by Process Name",
                                                                                  "Subtitle":  "% CPU"
                                                                              },
                                                                   "LineChart":  {
                                                                                     "Query":  "ITPC_CTX_Process_CL | where Name_s != \"System Idle Process\" | summarize AggregatedValue = avg(PercentProcessorTime_d) by Name_s\r\n// Oql: Type=ITPC_CTX_Process_CL not Name_s:\"System Idle Process\"  |measure avg(PercentProcessorTime_d) by Name_s",
                                                                                     "Callout":  {
                                                                                                     "Title":  "Max",
                                                                                                     "Series":  "",
                                                                                                     "Operation":  "Average"
                                                                                                 },
                                                                                     "yAxis":  {
                                                                                                   "isLogarithmic":  false,
                                                                                                   "units":  {
                                                                                                                 "baseUnitType":  "",
                                                                                                                 "baseUnit":  "",
                                                                                                                 "displayUnit":  ""
                                                                                                             },
                                                                                                   "customLabel":  ""
                                                                                               },
                                                                                     "NavigationSelect":  {

                                                                                                          }
                                                                                 },
                                                                   "List":  {
                                                                                "Query":  "ITPC_CTX_Process_CL | where Name_s != \"System Idle Process\" | summarize AggregatedValue = avg(PercentProcessorTime_d) by Name_s\r\n// Oql: Type=ITPC_CTX_Process_CL not Name_s:\"System Idle Process\"  |measure avg(PercentProcessorTime_d) by Name_s",
                                                                                "HideGraph":  false,
                                                                                "enableSparklines":  true,
                                                                                "operation":  "Summary",
                                                                                "ColumnsTitle":  {
                                                                                                     "Name":  "Name",
                                                                                                     "Value":  "%"
                                                                                                 },
                                                                                "Color":  "#0072c6",
                                                                                "thresholds":  {
                                                                                                   "isEnabled":  false,
                                                                                                   "values":  [
                                                                                                                  {
                                                                                                                      "name":  "Normal",
                                                                                                                      "threshold":  "Default",
                                                                                                                      "color":  "#009e49",
                                                                                                                      "isDefault":  true
                                                                                                                  },
                                                                                                                  {
                                                                                                                      "name":  "Warning",
                                                                                                                      "threshold":  "60",
                                                                                                                      "color":  "#fcd116",
                                                                                                                      "isDefault":  false
                                                                                                                  },
                                                                                                                  {
                                                                                                                      "name":  "Error",
                                                                                                                      "threshold":  "90",
                                                                                                                      "color":  "#ba141a",
                                                                                                                      "isDefault":  false
                                                                                                                  }
                                                                                                              ]
                                                                                               },
                                                                                "NameDSVSeparator":  "",
                                                                                "NavigationQuery":  "search in (ITPC_CTX_Process_CL) {selected item} | summarize CPU_Perc = max(PercentProcessorTime_d) by UserName_s, Worker_s, bin(TimeGenerated, 1h) | sort by TimeGenerated desc | render timechart\r\n// Oql: {selected item} Type=ITPC_CTX_Process_CL | measure max(PercentProcessorTime_d) as CPU_Perc by UserName_s,Worker_s | display LineChart",
                                                                                "NavigationSelect":  {

                                                                                                     }
                                                                            }
                                                               }
                                         },
                                         {
                                             "Id":  "LineChartCalloutBuilderBlade",
                                             "Type":  "Blade",
                                             "Version":  0,
                                             "Configuration":  {
                                                                   "General":  {
                                                                                   "title":  "Process Memory Consumption Phy (Avg)",
                                                                                   "newGroup":  true,
                                                                                   "icon":  "",
                                                                                   "useIcon":  false
                                                                               },
                                                                   "Header":  {
                                                                                  "Title":  "Overall by Process Name",
                                                                                  "Subtitle":  "Byte"
                                                                              },
                                                                   "LineChart":  {
                                                                                     "Query":  "ITPC_CTX_Process_CL | where Name_s != \"System Idle Process\" | summarize AggregatedValue = avg(WorkingSet_d) by Name_s\r\n// Oql: Type=ITPC_CTX_Process_CL not Name_s:\"System Idle Process\"  |measure avg(WorkingSet_d) by Name_s",
                                                                                     "Callout":  {
                                                                                                     "Title":  "Avg",
                                                                                                     "Series":  "",
                                                                                                     "Operation":  "Average"
                                                                                                 },
                                                                                     "yAxis":  {
                                                                                                   "isLogarithmic":  false,
                                                                                                   "units":  {
                                                                                                                 "baseUnitType":  "",
                                                                                                                 "baseUnit":  "",
                                                                                                                 "displayUnit":  ""
                                                                                                             },
                                                                                                   "customLabel":  ""
                                                                                               },
                                                                                     "NavigationSelect":  {

                                                                                                          }
                                                                                 },
                                                                   "List":  {
                                                                                "Query":  "ITPC_CTX_Process_CL | where Name_s != \"System Idle Process\" | summarize AggregatedValue = avg(WorkingSet_d) by Name_s\r\n// Oql: Type=ITPC_CTX_Process_CL not Name_s:\"System Idle Process\"  |measure avg(WorkingSet_d) by Name_s",
                                                                                "HideGraph":  false,
                                                                                "enableSparklines":  true,
                                                                                "operation":  "Summary",
                                                                                "ColumnsTitle":  {
                                                                                                     "Name":  "Name",
                                                                                                     "Value":  "Byte"
                                                                                                 },
                                                                                "Color":  "#0072c6",
                                                                                "thresholds":  {
                                                                                                   "isEnabled":  false,
                                                                                                   "values":  [
                                                                                                                  {
                                                                                                                      "name":  "Normal",
                                                                                                                      "threshold":  "Default",
                                                                                                                      "color":  "#009e49",
                                                                                                                      "isDefault":  true
                                                                                                                  },
                                                                                                                  {
                                                                                                                      "name":  "Warning",
                                                                                                                      "threshold":  "60",
                                                                                                                      "color":  "#fcd116",
                                                                                                                      "isDefault":  false
                                                                                                                  },
                                                                                                                  {
                                                                                                                      "name":  "Error",
                                                                                                                      "threshold":  "90",
                                                                                                                      "color":  "#ba141a",
                                                                                                                      "isDefault":  false
                                                                                                                  }
                                                                                                              ]
                                                                                               },
                                                                                "NameDSVSeparator":  "",
                                                                                "NavigationQuery":  "search in (ITPC_CTX_Process_CL) {selected item} | summarize Memory_Byte = avg(WorkingSet_d) by UserName_s, Worker_s, bin(TimeGenerated, 1h) | sort by TimeGenerated desc | render timechart\r\n// Oql: {selected item} Type=ITPC_CTX_Process_CL | measure avg(WorkingSet_d) as Memory_Byte by UserName_s,Worker_s | display LineChart",
                                                                                "NavigationSelect":  {

                                                                                                     }
                                                                            }
                                                               }
                                         },
                                         {
                                             "Id":  "LineChartCalloutBuilderBlade",
                                             "Type":  "Blade",
                                             "Version":  0,
                                             "Configuration":  {
                                                                   "General":  {
                                                                                   "title":  "Process Memory Consumption Phy (Max)",
                                                                                   "newGroup":  false,
                                                                                   "icon":  "",
                                                                                   "useIcon":  false
                                                                               },
                                                                   "Header":  {
                                                                                  "Title":  "Overall by Process Name",
                                                                                  "Subtitle":  ""
                                                                              },
                                                                   "LineChart":  {
                                                                                     "Query":  "ITPC_CTX_Process_CL | where Name_s != \"System Idle Process\" | summarize AggregatedValue = max(WorkingSet_d) by Name_s\r\n// Oql: Type=ITPC_CTX_Process_CL not Name_s:\"System Idle Process\"  |measure max(WorkingSet_d) by Name_s",
                                                                                     "Callout":  {
                                                                                                     "Title":  "Avg",
                                                                                                     "Series":  "",
                                                                                                     "Operation":  "Average"
                                                                                                 },
                                                                                     "yAxis":  {
                                                                                                   "isLogarithmic":  false,
                                                                                                   "units":  {
                                                                                                                 "baseUnitType":  "",
                                                                                                                 "baseUnit":  "",
                                                                                                                 "displayUnit":  ""
                                                                                                             },
                                                                                                   "customLabel":  ""
                                                                                               },
                                                                                     "NavigationSelect":  {

                                                                                                          }
                                                                                 },
                                                                   "List":  {
                                                                                "Query":  "ITPC_CTX_Process_CL | where Name_s != \"System Idle Process\" | summarize AggregatedValue = max(WorkingSet_d) by Name_s\r\n// Oql: Type=ITPC_CTX_Process_CL not Name_s:\"System Idle Process\"  |measure max(WorkingSet_d) by Name_s",
                                                                                "HideGraph":  false,
                                                                                "enableSparklines":  true,
                                                                                "operation":  "Summary",
                                                                                "ColumnsTitle":  {
                                                                                                     "Name":  "Name",
                                                                                                     "Value":  "Byte"
                                                                                                 },
                                                                                "Color":  "#0072c6",
                                                                                "thresholds":  {
                                                                                                   "isEnabled":  false,
                                                                                                   "values":  [
                                                                                                                  {
                                                                                                                      "name":  "Normal",
                                                                                                                      "threshold":  "Default",
                                                                                                                      "color":  "#009e49",
                                                                                                                      "isDefault":  true
                                                                                                                  },
                                                                                                                  {
                                                                                                                      "name":  "Warning",
                                                                                                                      "threshold":  "60",
                                                                                                                      "color":  "#fcd116",
                                                                                                                      "isDefault":  false
                                                                                                                  },
                                                                                                                  {
                                                                                                                      "name":  "Error",
                                                                                                                      "threshold":  "90",
                                                                                                                      "color":  "#ba141a",
                                                                                                                      "isDefault":  false
                                                                                                                  }
                                                                                                              ]
                                                                                               },
                                                                                "NameDSVSeparator":  "",
                                                                                "NavigationQuery":  "search in (ITPC_CTX_Process_CL) {selected item} | summarize Memory_Byte = max(WorkingSet_d) by UserName_s, Worker_s, bin(TimeGenerated, 1h) | sort by TimeGenerated desc | render timechart\r\n// Oql: {selected item} Type=ITPC_CTX_Process_CL | measure max(WorkingSet_d) as Memory_Byte by UserName_s,Worker_s | display LineChart",
                                                                                "NavigationSelect":  {

                                                                                                     }
                                                                            }
                                                               }
                                         },
                                         {
                                             "Id":  "LineChartCalloutBuilderBlade",
                                             "Type":  "Blade",
                                             "Version":  0,
                                             "Configuration":  {
                                                                   "General":  {
                                                                                   "title":  "Process IO Activity (Avg)",
                                                                                   "newGroup":  true,
                                                                                   "icon":  "",
                                                                                   "useIcon":  false
                                                                               },
                                                                   "Header":  {
                                                                                  "Title":  "Overall by Process name",
                                                                                  "Subtitle":  "Byte/s"
                                                                              },
                                                                   "LineChart":  {
                                                                                     "Query":  "ITPC_CTX_Process_CL | where Name_s != \"System Idle Process\" | summarize AggregatedValue = avg(IODataBytesPersec_d) by Name_s\r\n// Oql: Type=ITPC_CTX_Process_CL not Name_s:\"System Idle Process\"  |measure avg(IODataBytesPersec_d) by Name_s",
                                                                                     "Callout":  {
                                                                                                     "Title":  "Avg",
                                                                                                     "Series":  "",
                                                                                                     "Operation":  "Last Sample"
                                                                                                 },
                                                                                     "yAxis":  {
                                                                                                   "isLogarithmic":  false,
                                                                                                   "units":  {
                                                                                                                 "baseUnitType":  "",
                                                                                                                 "baseUnit":  "",
                                                                                                                 "displayUnit":  ""
                                                                                                             },
                                                                                                   "customLabel":  ""
                                                                                               },
                                                                                     "NavigationSelect":  {

                                                                                                          }
                                                                                 },
                                                                   "List":  {
                                                                                "Query":  "ITPC_CTX_Process_CL | where Name_s != \"System Idle Process\" | summarize AggregatedValue = avg(IODataBytesPersec_d) by Name_s\r\n// Oql: Type=ITPC_CTX_Process_CL not Name_s:\"System Idle Process\"  |measure avg(IODataBytesPersec_d) by Name_s",
                                                                                "HideGraph":  false,
                                                                                "enableSparklines":  true,
                                                                                "operation":  "Summary",
                                                                                "ColumnsTitle":  {
                                                                                                     "Name":  "Name",
                                                                                                     "Value":  "Byte/s"
                                                                                                 },
                                                                                "Color":  "#0072c6",
                                                                                "thresholds":  {
                                                                                                   "isEnabled":  false,
                                                                                                   "values":  [
                                                                                                                  {
                                                                                                                      "name":  "Normal",
                                                                                                                      "threshold":  "Default",
                                                                                                                      "color":  "#009e49",
                                                                                                                      "isDefault":  true
                                                                                                                  },
                                                                                                                  {
                                                                                                                      "name":  "Warning",
                                                                                                                      "threshold":  "60",
                                                                                                                      "color":  "#fcd116",
                                                                                                                      "isDefault":  false
                                                                                                                  },
                                                                                                                  {
                                                                                                                      "name":  "Error",
                                                                                                                      "threshold":  "90",
                                                                                                                      "color":  "#ba141a",
                                                                                                                      "isDefault":  false
                                                                                                                  }
                                                                                                              ]
                                                                                               },
                                                                                "NameDSVSeparator":  "",
                                                                                "NavigationQuery":  "search in (ITPC_CTX_Process_CL) {selected item} | summarize IO_BpS = avg(IODataBytesPersec_d) by UserName_s, Worker_s, bin(TimeGenerated, 1h) | sort by TimeGenerated desc | render timechart\r\n// Oql: {selected item} Type=ITPC_CTX_Process_CL | measure avg(IODataBytesPersec_d) as IO_BpS by UserName_s,Worker_s | display LineChart",
                                                                                "NavigationSelect":  {

                                                                                                     }
                                                                            }
                                                               }
                                         },
                                         {
                                             "Id":  "LineChartCalloutBuilderBlade",
                                             "Type":  "Blade",
                                             "Version":  0,
                                             "Configuration":  {
                                                                   "General":  {
                                                                                   "title":  "Process IO Activity (Max)",
                                                                                   "newGroup":  false,
                                                                                   "icon":  "",
                                                                                   "useIcon":  false
                                                                               },
                                                                   "Header":  {
                                                                                  "Title":  "Overall by Process name",
                                                                                  "Subtitle":  "Byte/s"
                                                                              },
                                                                   "LineChart":  {
                                                                                     "Query":  "ITPC_CTX_Process_CL | where Name_s != \"System Idle Process\" | summarize AggregatedValue = max(IODataBytesPersec_d) by Name_s\r\n// Oql: Type=ITPC_CTX_Process_CL not Name_s:\"System Idle Process\"  |measure max(IODataBytesPersec_d) by Name_s",
                                                                                     "Callout":  {
                                                                                                     "Title":  "Avg",
                                                                                                     "Series":  "",
                                                                                                     "Operation":  "Average"
                                                                                                 },
                                                                                     "yAxis":  {
                                                                                                   "isLogarithmic":  false,
                                                                                                   "units":  {
                                                                                                                 "baseUnitType":  "",
                                                                                                                 "baseUnit":  "",
                                                                                                                 "displayUnit":  ""
                                                                                                             },
                                                                                                   "customLabel":  ""
                                                                                               },
                                                                                     "NavigationSelect":  {

                                                                                                          }
                                                                                 },
                                                                   "List":  {
                                                                                "Query":  "ITPC_CTX_Process_CL | where Name_s != \"System Idle Process\" | summarize AggregatedValue = max(IODataBytesPersec_d) by Name_s\r\n// Oql: Type=ITPC_CTX_Process_CL not Name_s:\"System Idle Process\"  |measure max(IODataBytesPersec_d) by Name_s",
                                                                                "HideGraph":  false,
                                                                                "enableSparklines":  true,
                                                                                "operation":  "Summary",
                                                                                "ColumnsTitle":  {
                                                                                                     "Name":  "Name",
                                                                                                     "Value":  "byte/s"
                                                                                                 },
                                                                                "Color":  "#0072c6",
                                                                                "thresholds":  {
                                                                                                   "isEnabled":  false,
                                                                                                   "values":  [
                                                                                                                  {
                                                                                                                      "name":  "Normal",
                                                                                                                      "threshold":  "Default",
                                                                                                                      "color":  "#009e49",
                                                                                                                      "isDefault":  true
                                                                                                                  },
                                                                                                                  {
                                                                                                                      "name":  "Warning",
                                                                                                                      "threshold":  "60",
                                                                                                                      "color":  "#fcd116",
                                                                                                                      "isDefault":  false
                                                                                                                  },
                                                                                                                  {
                                                                                                                      "name":  "Error",
                                                                                                                      "threshold":  "90",
                                                                                                                      "color":  "#ba141a",
                                                                                                                      "isDefault":  false
                                                                                                                  }
                                                                                                              ]
                                                                                               },
                                                                                "NameDSVSeparator":  "",
                                                                                "NavigationQuery":  "search in (ITPC_CTX_Process_CL) {selected item} | summarize IO_BpS = max(IODataBytesPersec_d) by UserName_s, Worker_s, bin(TimeGenerated, 1h) | sort by TimeGenerated desc | render timechart\r\n// Oql: {selected item} Type=ITPC_CTX_Process_CL | measure max(IODataBytesPersec_d) as IO_BpS by UserName_s,Worker_s | display LineChart",
                                                                                "NavigationSelect":  {

                                                                                                     }
                                                                            }
                                                               }
                                         }
                                     ],
                       "Filters":  [

                                   ],
                       "OverviewTile":  {
                                            "Id":  "SingleQueryDonutBuilderTileV1",
                                            "Type":  "OverviewTile",
                                            "Version":  2,
                                            "Configuration":  {
                                                                  "Donut":  {
                                                                                "Query":  "ITPC_CTX_Process_CL | where TimeGenerated \u003e ago(60m) | summarize AggregatedValue = dcount(NameInSession_s) by Worker_s | sort by AggregatedValue desc\r\n// Oql: Type=ITPC_CTX_Process_CL TimeGenerated\u003eNOW-60MINUTES| measure countdistinct(NameInSession_s) by Worker_s",
                                                                                "CenterLegend":  {
                                                                                                     "Text":  "Total",
                                                                                                     "Operation":  "Sum",
                                                                                                     "ArcsToSelect":  [

                                                                                                                      ]
                                                                                                 },
                                                                                "Options":  {
                                                                                                "colors":  [
                                                                                                               "#00188f",
                                                                                                               "#0072c6",
                                                                                                               "#00bcf2"
                                                                                                           ],
                                                                                                "valueColorMapping":  [

                                                                                                                      ],
                                                                                                "legend":  true,
                                                                                                "skipLegendPositioning":  true,
                                                                                                "center":  true,
                                                                                                "unitType":  "Count",
                                                                                                "fromUnit":  "Ones"
                                                                                            },
                                                                                "HideOtherLegend":  true
                                                                            },
                                                                  "Advanced":  {
                                                                                   "DataFlowVerification":  {
                                                                                                                "Enabled":  false,
                                                                                                                "Query":  "search *\r\n// Oql: *",
                                                                                                                "Message":  ""
                                                                                                            }
                                                                               }
                                                              }
                                        }
                   }
}
,
{
    "apiVersion":  "2015-11-01-preview",
    "name":  "Citrix Sessions",
    "type":  "views",
    "location":  "[parameters('location')]",
    "id":  "[Concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.OperationalInsights/workspaces/', parameters('workspace'),'/views/Citrix Sessions')]",
    "dependson":  [
                      "[Concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.OperationalInsights/workspaces/', parameters('workspace'))]"
                  ],
    "properties":  {
                       "Id":  "Citrix Sessions",
                       "Name":  "Citrix Sessions",
                       "Author":  "marcel.meurer@sepago.de",
                       "Source":  "Local",
                       "Version":  2,
                       "Dashboard":  [
                                         {
                                             "Id":  "SingleQueryDonutBuilderBladeV1",
                                             "Type":  "Blade",
                                             "Version":  0,
                                             "Configuration":  {
                                                                   "General":  {
                                                                                   "title":  "Citrix Sessions",
                                                                                   "newGroup":  false,
                                                                                   "icon":  "",
                                                                                   "useIcon":  false
                                                                               },
                                                                   "Header":  {
                                                                                  "Title":  "Citrix Sessions",
                                                                                  "Subtitle":  "Unique Sessions State"
                                                                              },
                                                                   "Donut":  {
                                                                                 "Query":  "ITPC_CTX_Session_CL | summarize AggregatedValue = dcount(SessionHash_s) by ConnectionState_s | sort by AggregatedValue desc",
                                                                                 "CenterLegend":  {
                                                                                                      "Text":  "Total",
                                                                                                      "Operation":  "Sum",
                                                                                                      "ArcsToSelect":  [

                                                                                                                       ]
                                                                                                  },
                                                                                 "Options":  {
                                                                                                 "colors":  [
                                                                                                                "#00188f",
                                                                                                                "#0072c6",
                                                                                                                "#00bcf2"
                                                                                                            ],
                                                                                                 "valueColorMapping":  [

                                                                                                                       ]
                                                                                             },
                                                                                 "NavigationSelect":  {

                                                                                                      }
                                                                             },
                                                                   "List":  {
                                                                                "Query":  "ITPC_CTX_PerfData_CL | where Category == \"Terminal Services\" and Counter_s == \"Active Sessions\" | summarize AggregatedValue = avg(value_d) by Worker_s",
                                                                                "HideGraph":  false,
                                                                                "enableSparklines":  true,
                                                                                "ColumnsTitle":  {
                                                                                                     "Name":  "Worker",
                                                                                                     "Value":  "Active"
                                                                                                 },
                                                                                "Color":  "#0072c6",
                                                                                "thresholds":  {
                                                                                                   "isEnabled":  false,
                                                                                                   "values":  [
                                                                                                                  {
                                                                                                                      "name":  "Normal",
                                                                                                                      "threshold":  "Default",
                                                                                                                      "color":  "#009e49",
                                                                                                                      "isDefault":  true
                                                                                                                  },
                                                                                                                  {
                                                                                                                      "name":  "Warning",
                                                                                                                      "threshold":  "60",
                                                                                                                      "color":  "#fcd116",
                                                                                                                      "isDefault":  false
                                                                                                                  },
                                                                                                                  {
                                                                                                                      "name":  "Error",
                                                                                                                      "threshold":  "90",
                                                                                                                      "color":  "#ba141a",
                                                                                                                      "isDefault":  false
                                                                                                                  }
                                                                                                              ]
                                                                                               },
                                                                                "NameDSVSeparator":  "",
                                                                                "NavigationQuery":  "search {selected item} | sort by TimeGenerated desc",
                                                                                "NavigationSelect":  {
                                                                                                         "NavigationQuery":  "search {selected item} | sort by TimeGenerated desc"
                                                                                                     }
                                                                            }
                                                               }
                                         },
                                         {
                                             "Id":  "LineChartCalloutBuilderBlade",
                                             "Type":  "Blade",
                                             "Version":  0,
                                             "Configuration":  {
                                                                   "General":  {
                                                                                   "title":  "Logon Duration",
                                                                                   "newGroup":  true,
                                                                                   "icon":  "",
                                                                                   "useIcon":  false
                                                                               },
                                                                   "Header":  {
                                                                                  "Title":  "Logon Duration",
                                                                                  "Subtitle":  "in seconds"
                                                                              },
                                                                   "LineChart":  {
                                                                                     "Query":  "ITPC_CTX_Session_CL | where ConnectionState_s == \"Active\" | summarize Duration = avg(LogonDuration_d) by Worker_s, bin(TimeGenerated, 1h) | sort by TimeGenerated desc | where Duration \u003e 0 | render timechart// Oql: Type=ITPC_CTX_Session_CL ConnectionState_s=\"Active\"|measure avg(LogonDuration_d) as Duration by Worker_s | where Duration\u003e0|display LineChart",
                                                                                     "Callout":  {
                                                                                                     "Title":  "Avg per hour",
                                                                                                     "Series":  "",
                                                                                                     "Operation":  "Average"
                                                                                                 },
                                                                                     "yAxis":  {
                                                                                                   "isLogarithmic":  false,
                                                                                                   "units":  {
                                                                                                                 "baseUnitType":  "",
                                                                                                                 "baseUnit":  "",
                                                                                                                 "displayUnit":  ""
                                                                                                             },
                                                                                                   "customLabel":  ""
                                                                                               },
                                                                                     "NavigationSelect":  {

                                                                                                          }
                                                                                 },
                                                                   "List":  {
                                                                                "Query":  "ITPC_CTX_Session_CL | where ConnectionState_s == \"Active\" | summarize Duration = avg(LogonDuration_d) by UserName_s | where Duration \u003e 0|order by Duration desc ",
                                                                                "HideGraph":  false,
                                                                                "enableSparklines":  false,
                                                                                "operation":  "Summary",
                                                                                "ColumnsTitle":  {
                                                                                                     "Name":  "User",
                                                                                                     "Value":  "seconds"
                                                                                                 },
                                                                                "Color":  "#0072c6",
                                                                                "thresholds":  {
                                                                                                   "isEnabled":  true,
                                                                                                   "values":  [
                                                                                                                  {
                                                                                                                      "name":  "Normal",
                                                                                                                      "threshold":  "Default",
                                                                                                                      "color":  "#009e49",
                                                                                                                      "isDefault":  true
                                                                                                                  },
                                                                                                                  {
                                                                                                                      "name":  "Warning",
                                                                                                                      "threshold":  "50",
                                                                                                                      "color":  "#fcd116",
                                                                                                                      "isDefault":  false
                                                                                                                  },
                                                                                                                  {
                                                                                                                      "name":  "Error",
                                                                                                                      "threshold":  "120",
                                                                                                                      "color":  "#ba141a",
                                                                                                                      "isDefault":  false
                                                                                                                  }
                                                                                                              ]
                                                                                               },
                                                                                "NameDSVSeparator":  "",
                                                                                "NavigationQuery":  "search {selected item} | sort by TimeGenerated desc",
                                                                                "NavigationSelect":  {
                                                                                                         "NavigationQuery":  "search {selected item} | sort by TimeGenerated desc"
                                                                                                     }
                                                                            }
                                                               }
                                         },
                                         {
                                             "Id":  "LineChartCalloutBuilderBlade",
                                             "Type":  "Blade",
                                             "Version":  0,
                                             "Configuration":  {
                                                                   "General":  {
                                                                                   "title":  "Session Output Bandwidth",
                                                                                   "newGroup":  true,
                                                                                   "icon":  "",
                                                                                   "useIcon":  false
                                                                               },
                                                                   "Header":  {
                                                                                  "Title":  "Average Bandwidth per Worker",
                                                                                  "Subtitle":  "bit/s"
                                                                              },
                                                                   "LineChart":  {
                                                                                     "Query":  "ITPC_CTX_PerfData_CL | where Category == \"ICA Session\" and Counter_s == \"Output Session Bandwidth\" and Instance_s != \"_Server Total\" | summarize AggregatedValue = avg(value_d) by Worker_s, bin(TimeGenerated, 1h) | sort by TimeGenerated desc | render timechart",
                                                                                     "Callout":  {
                                                                                                     "Title":  "Avg ",
                                                                                                     "Series":  "",
                                                                                                     "Operation":  "Average"
                                                                                                 },
                                                                                     "yAxis":  {
                                                                                                   "isLogarithmic":  false,
                                                                                                   "units":  {
                                                                                                                 "baseUnitType":  "",
                                                                                                                 "baseUnit":  "",
                                                                                                                 "displayUnit":  ""
                                                                                                             },
                                                                                                   "customLabel":  ""
                                                                                               },
                                                                                     "NavigationSelect":  {

                                                                                                          }
                                                                                 },
                                                                   "List":  {
                                                                                "Query":  "ITPC_CTX_PerfData_CL | where Category == \"ICA Session\" and Counter_s == \"Output Session Bandwidth\" | summarize AggregatedValue = avg(value_d) by UserName_s, Worker_s|order by  AggregatedValue desc ",
                                                                                "HideGraph":  false,
                                                                                "enableSparklines":  true,
                                                                                "operation":  "Summary",
                                                                                "ColumnsTitle":  {
                                                                                                     "Name":  "User",
                                                                                                     "Value":  "bit/s"
                                                                                                 },
                                                                                "Color":  "#0072c6",
                                                                                "thresholds":  {
                                                                                                   "isEnabled":  true,
                                                                                                   "values":  [
                                                                                                                  {
                                                                                                                      "name":  "Normal",
                                                                                                                      "threshold":  "Default",
                                                                                                                      "color":  "#009e49",
                                                                                                                      "isDefault":  true
                                                                                                                  },
                                                                                                                  {
                                                                                                                      "name":  "Warning",
                                                                                                                      "threshold":  "200000",
                                                                                                                      "color":  "#fcd116",
                                                                                                                      "isDefault":  false
                                                                                                                  },
                                                                                                                  {
                                                                                                                      "name":  "Error",
                                                                                                                      "threshold":  "1000000",
                                                                                                                      "color":  "#ba141a",
                                                                                                                      "isDefault":  false
                                                                                                                  }
                                                                                                              ]
                                                                                               },
                                                                                "NameDSVSeparator":  "",
                                                                                "NavigationQuery":  "ITPC_CTX_PerfData_CL | where ( Category == \"ICA Session\" and Counter_s == \"Input Session Bandwidth\" and {selected item} )   | summarize AggregatedValue = avg(value_d) by TimeGenerated  | render timechart ",
                                                                                "NavigationSelect":  {
                                                                                                         "NavigationQuery":  "ITPC_CTX_PerfData_CL | where ( Category == \"ICA Session\" and Counter_s == \"Input Session Bandwidth\" and {selected item} )   | summarize AggregatedValue = avg(value_d) by TimeGenerated  | render timechart "
                                                                                                     }
                                                                            }
                                                               }
                                         },
                                         {
                                             "Id":  "LineChartCalloutBuilderBlade",
                                             "Type":  "Blade",
                                             "Version":  0,
                                             "Configuration":  {
                                                                   "General":  {
                                                                                   "title":  "Session Input Bandwidth",
                                                                                   "newGroup":  false,
                                                                                   "icon":  "",
                                                                                   "useIcon":  false
                                                                               },
                                                                   "Header":  {
                                                                                  "Title":  "Average Bandwidth per Worker",
                                                                                  "Subtitle":  "bit/s"
                                                                              },
                                                                   "LineChart":  {
                                                                                     "Query":  "ITPC_CTX_PerfData_CL | where Category == \"ICA Session\" and Counter_s == \"Input Session Bandwidth\" and Instance_s != \"_Server Total\" | summarize AggregatedValue = avg(value_d) by Worker_s, bin(TimeGenerated, 1h) | sort by TimeGenerated desc | render timechart",
                                                                                     "Callout":  {
                                                                                                     "Title":  "Avg",
                                                                                                     "Series":  "",
                                                                                                     "Operation":  "Average"
                                                                                                 },
                                                                                     "yAxis":  {
                                                                                                   "isLogarithmic":  false,
                                                                                                   "units":  {
                                                                                                                 "baseUnitType":  "",
                                                                                                                 "baseUnit":  "",
                                                                                                                 "displayUnit":  ""
                                                                                                             },
                                                                                                   "customLabel":  ""
                                                                                               },
                                                                                     "NavigationSelect":  {

                                                                                                          }
                                                                                 },
                                                                   "List":  {
                                                                                "Query":  "ITPC_CTX_PerfData_CL | where Category == \"ICA Session\" and Counter_s == \"Input Session Bandwidth\" | summarize AggregatedValue = avg(value_d) by UserName_s, Worker_s",
                                                                                "HideGraph":  false,
                                                                                "enableSparklines":  true,
                                                                                "operation":  "Summary",
                                                                                "ColumnsTitle":  {
                                                                                                     "Name":  "User",
                                                                                                     "Value":  "bit/s"
                                                                                                 },
                                                                                "Color":  "#0072c6",
                                                                                "thresholds":  {
                                                                                                   "isEnabled":  false,
                                                                                                   "values":  [
                                                                                                                  {
                                                                                                                      "name":  "Normal",
                                                                                                                      "threshold":  "Default",
                                                                                                                      "color":  "#009e49",
                                                                                                                      "isDefault":  true
                                                                                                                  },
                                                                                                                  {
                                                                                                                      "name":  "Warning",
                                                                                                                      "threshold":  "60",
                                                                                                                      "color":  "#fcd116",
                                                                                                                      "isDefault":  false
                                                                                                                  },
                                                                                                                  {
                                                                                                                      "name":  "Error",
                                                                                                                      "threshold":  "90",
                                                                                                                      "color":  "#ba141a",
                                                                                                                      "isDefault":  false
                                                                                                                  }
                                                                                                              ]
                                                                                               },
                                                                                "NameDSVSeparator":  "",
                                                                                "NavigationQuery":  "ITPC_CTX_PerfData_CL | where Category == \"ICA Session\" and Counter_s == \"Input Session Bandwidth\"  and {selected item} | summarize AggregatedValue = avg(value_d) by TimeGenerated  | render timechart ",
                                                                                "NavigationSelect":  {
                                                                                                         "NavigationQuery":  "ITPC_CTX_PerfData_CL | where Category == \"ICA Session\" and Counter_s == \"Input Session Bandwidth\"  and {selected item} | summarize AggregatedValue = avg(value_d) by TimeGenerated  | render timechart "
                                                                                                     }
                                                                            }
                                                               }
                                         },
                                         {
                                             "Id":  "LineChartCalloutBuilderBlade",
                                             "Type":  "Blade",
                                             "Version":  0,
                                             "Configuration":  {
                                                                   "General":  {
                                                                                   "title":  "Session Latency",
                                                                                   "newGroup":  false,
                                                                                   "icon":  "",
                                                                                   "useIcon":  false
                                                                               },
                                                                   "Header":  {
                                                                                  "Title":  "Average Latency per Worker",
                                                                                  "Subtitle":  "ms"
                                                                              },
                                                                   "LineChart":  {
                                                                                     "Query":  "ITPC_CTX_PerfData_CL | where Category == \"ICA Session\" and Counter_s == \"Latency - Last Recorded\" and Instance_s != \"_Server Total\" | summarize AggregatedValue = avg(value_d) by Worker_s, bin(TimeGenerated, 1h) | sort by TimeGenerated desc | render timechart",
                                                                                     "Callout":  {
                                                                                                     "Title":  "Avg",
                                                                                                     "Series":  "",
                                                                                                     "Operation":  "Average"
                                                                                                 },
                                                                                     "yAxis":  {
                                                                                                   "isLogarithmic":  false,
                                                                                                   "units":  {
                                                                                                                 "baseUnitType":  "",
                                                                                                                 "baseUnit":  "",
                                                                                                                 "displayUnit":  ""
                                                                                                             },
                                                                                                   "customLabel":  ""
                                                                                               },
                                                                                     "NavigationSelect":  {

                                                                                                          }
                                                                                 },
                                                                   "List":  {
                                                                                "Query":  "ITPC_CTX_PerfData_CL | where Category == \"ICA Session\" and Counter_s == \"Latency - Last Recorded\" | summarize AggregatedValue = avg(value_d) by UserName_s, Worker_s|order by AggregatedValue desc ",
                                                                                "HideGraph":  false,
                                                                                "enableSparklines":  true,
                                                                                "operation":  "Summary",
                                                                                "ColumnsTitle":  {
                                                                                                     "Name":  "User",
                                                                                                     "Value":  "ms"
                                                                                                 },
                                                                                "Color":  "#0072c6",
                                                                                "thresholds":  {
                                                                                                   "isEnabled":  true,
                                                                                                   "values":  [
                                                                                                                  {
                                                                                                                      "name":  "Normal",
                                                                                                                      "threshold":  "Default",
                                                                                                                      "color":  "#009e49",
                                                                                                                      "isDefault":  true
                                                                                                                  },
                                                                                                                  {
                                                                                                                      "name":  "Warning",
                                                                                                                      "threshold":  "350",
                                                                                                                      "color":  "#fcd116",
                                                                                                                      "isDefault":  false
                                                                                                                  },
                                                                                                                  {
                                                                                                                      "name":  "Error",
                                                                                                                      "threshold":  "600",
                                                                                                                      "color":  "#ba141a",
                                                                                                                      "isDefault":  false
                                                                                                                  }
                                                                                                              ]
                                                                                               },
                                                                                "NameDSVSeparator":  "",
                                                                                "NavigationQuery":  "ITPC_CTX_PerfData_CL | where Category == \"ICA Session\" and Counter_s == \"Latency - Last Recorded\" and {selected item} | summarize AggregatedValue = avg(value_d) by TimeGenerated  | render timechart ",
                                                                                "NavigationSelect":  {
                                                                                                         "NavigationQuery":  "ITPC_CTX_PerfData_CL | where Category == \"ICA Session\" and Counter_s == \"Latency - Last Recorded\" and {selected item} | summarize AggregatedValue = avg(value_d) by TimeGenerated  | render timechart "
                                                                                                     }
                                                                            }
                                                               }
                                         },
                                         {
                                             "Id":  "LineChartCalloutBuilderBlade",
                                             "Type":  "Blade",
                                             "Version":  0,
                                             "Configuration":  {
                                                                   "General":  {
                                                                                   "title":  "Session Output Line Speed",
                                                                                   "newGroup":  false,
                                                                                   "icon":  "",
                                                                                   "useIcon":  false
                                                                               },
                                                                   "Header":  {
                                                                                  "Title":  "Average Output Line Speed per Worker",
                                                                                  "Subtitle":  "bit/s"
                                                                              },
                                                                   "LineChart":  {
                                                                                     "Query":  "ITPC_CTX_PerfData_CL | where Category == \"ICA Session\" and Counter_s == \"Output Session Line Speed\" and Instance_s != \"_Server Total\" | summarize AggregatedValue = avg(value_d) by Worker_s, bin(TimeGenerated, 1h) | sort by TimeGenerated desc | render timechart",
                                                                                     "Callout":  {
                                                                                                     "Title":  "Avg",
                                                                                                     "Series":  "",
                                                                                                     "Operation":  "Average"
                                                                                                 },
                                                                                     "yAxis":  {
                                                                                                   "isLogarithmic":  false,
                                                                                                   "units":  {
                                                                                                                 "baseUnitType":  "",
                                                                                                                 "baseUnit":  "",
                                                                                                                 "displayUnit":  ""
                                                                                                             },
                                                                                                   "customLabel":  ""
                                                                                               },
                                                                                     "NavigationSelect":  {

                                                                                                          }
                                                                                 },
                                                                   "List":  {
                                                                                "Query":  "ITPC_CTX_PerfData_CL | where Category == \"ICA Session\" and Counter_s == \"Output Session Line Speed\" | summarize AggregatedValue = avg(value_d) by UserName_s, Worker_s | order by AggregatedValue desc ",
                                                                                "HideGraph":  false,
                                                                                "enableSparklines":  true,
                                                                                "operation":  "Summary",
                                                                                "ColumnsTitle":  {
                                                                                                     "Name":  "User",
                                                                                                     "Value":  "Count"
                                                                                                 },
                                                                                "Color":  "#0072c6",
                                                                                "thresholds":  {
                                                                                                   "isEnabled":  true,
                                                                                                   "values":  [
                                                                                                                  {
                                                                                                                      "name":  "Error",
                                                                                                                      "threshold":  "Default",
                                                                                                                      "color":  "#ba141a",
                                                                                                                      "isDefault":  true
                                                                                                                  },
                                                                                                                  {
                                                                                                                      "name":  "Warning",
                                                                                                                      "threshold":  "1000000",
                                                                                                                      "color":  "#fcd116",
                                                                                                                      "isDefault":  false
                                                                                                                  },
                                                                                                                  {
                                                                                                                      "name":  "Error",
                                                                                                                      "threshold":  "2000000",
                                                                                                                      "color":  "#009e49",
                                                                                                                      "isDefault":  false
                                                                                                                  }
                                                                                                              ]
                                                                                               },
                                                                                "NameDSVSeparator":  "",
                                                                                "NavigationQuery":  "ITPC_CTX_PerfData_CL | where Category == \"ICA Session\" and Counter_s == \"Output Session Line Speed\" and {selected item} | summarize AggregatedValue = avg(value_d) by TimeGenerated  | render timechart ",
                                                                                "NavigationSelect":  {
                                                                                                         "NavigationQuery":  "ITPC_CTX_PerfData_CL | where Category == \"ICA Session\" and Counter_s == \"Output Session Line Speed\" and {selected item} | summarize AggregatedValue = avg(value_d) by TimeGenerated  | render timechart "
                                                                                                     }
                                                                            }
                                                               }
                                         },
                                         {
                                             "Id":  "LineChartCalloutStackedBuilderBlade",
                                             "Type":  "Blade",
                                             "Version":  0,
                                             "Configuration":  {
                                                                   "General":  {
                                                                                   "title":  "Session Maximum Values",
                                                                                   "newGroup":  true
                                                                               },
                                                                   "charts":  [
                                                                                  {
                                                                                      "Header":  {
                                                                                                     "Title":  "Maximum Output Bandwidth",
                                                                                                     "Subtitle":  "bit/s"
                                                                                                 },
                                                                                      "LineChart":  {
                                                                                                        "Query":  "ITPC_CTX_PerfData_CL | where Category == \"ICA Session\" and Counter_s == \"Output Session Bandwidth\" | summarize AggregatedValue = max(value_d) by Worker_s, bin(TimeGenerated, 1h) | sort by TimeGenerated desc | render timechart",
                                                                                                        "yAxis":  {
                                                                                                                      "isLogarithmic":  false,
                                                                                                                      "units":  {
                                                                                                                                    "baseUnitType":  "",
                                                                                                                                    "baseUnit":  "",
                                                                                                                                    "displayUnit":  ""
                                                                                                                                },
                                                                                                                      "customLabel":  ""
                                                                                                                  },
                                                                                                        "NavigationSelect":  {

                                                                                                                             }
                                                                                                    }
                                                                                  },
                                                                                  {
                                                                                      "Header":  {
                                                                                                     "Title":  "Maximum Input Bandwidth",
                                                                                                     "Subtitle":  "bit/s"
                                                                                                 },
                                                                                      "LineChart":  {
                                                                                                        "Query":  "ITPC_CTX_PerfData_CL | where Category == \"ICA Session\" and Counter_s == \"Input Session Bandwidth\" | summarize AggregatedValue = max(value_d) by Worker_s, bin(TimeGenerated, 1h) | sort by TimeGenerated desc | render timechart",
                                                                                                        "yAxis":  {
                                                                                                                      "isLogarithmic":  false,
                                                                                                                      "units":  {
                                                                                                                                    "baseUnitType":  "",
                                                                                                                                    "baseUnit":  "",
                                                                                                                                    "displayUnit":  ""
                                                                                                                                },
                                                                                                                      "customLabel":  ""
                                                                                                                  },
                                                                                                        "NavigationSelect":  {

                                                                                                                             }
                                                                                                    }
                                                                                  },
                                                                                  {
                                                                                      "Header":  {
                                                                                                     "Title":  "Maximum Latency",
                                                                                                     "Subtitle":  "ms"
                                                                                                 },
                                                                                      "LineChart":  {
                                                                                                        "Query":  "ITPC_CTX_PerfData_CL | where Category == \"ICA Session\" and Counter_s == \"Latency - Last Recorded\" | summarize AggregatedValue = max(value_d) by Worker_s, bin(TimeGenerated, 1h) | sort by TimeGenerated desc | render timechart",
                                                                                                        "yAxis":  {
                                                                                                                      "isLogarithmic":  false,
                                                                                                                      "units":  {
                                                                                                                                    "baseUnitType":  "",
                                                                                                                                    "baseUnit":  "",
                                                                                                                                    "displayUnit":  ""
                                                                                                                                },
                                                                                                                      "customLabel":  ""
                                                                                                                  },
                                                                                                        "NavigationSelect":  {

                                                                                                                             }
                                                                                                    }
                                                                                  }
                                                                              ]
                                                               }
                                         },
                                         {
                                             "Id":  "NotableQueriesBuilderBlade",
                                             "Type":  "Blade",
                                             "Version":  0,
                                             "Configuration":  {
                                                                   "General":  {
                                                                                   "title":  "Session Query List",
                                                                                   "newGroup":  false,
                                                                                   "preselectedFilters":  "Type, Computer",
                                                                                   "renderMode":  "grid"
                                                                               },
                                                                   "queries":  [
                                                                                   {
                                                                                       "query":  "ITPC_CTX_Session_CL | where TimeGenerated \u003e ago(60m) | sort by TimeGenerated desc, UserName_s asc",
                                                                                       "displayName":  "Connection List (Last 60 Minutes)"
                                                                                   },
                                                                                   {
                                                                                       "query":  "ITPC_CTX_Session_CL | distinct ClientName_s",
                                                                                       "displayName":  "Client Station Names"
                                                                                   },
                                                                                   {
                                                                                       "query":  "ITPC_CTX_PerfData_CL | where Category == \"ICA Session\" and Counter_s == \"Output Session Bandwidth\" and UserName_s == \"mmeurer\" | summarize AggregatedValue = avg(value_d) by Worker_s, bin(TimeGenerated, 30m) | sort by TimeGenerated desc",
                                                                                       "displayName":  "Session Output Bandwidth for a specific User"
                                                                                   },
                                                                                   {
                                                                                       "query":  "ITPC_CTX_PerfData_CL | where Category == \"ICA Session\" and Counter_s == \"Latency - Last Recorded\" and UserName_s == \"mmeurer\" | summarize AggregatedValue = avg(value_d) by Worker_s, bin(TimeGenerated, 30m) | sort by TimeGenerated desc",
                                                                                       "displayName":  "Session Latency for a specific User"
                                                                                   }
                                                                               ]
                                                               }
                                         }
                                     ],
                       "Filters":  [

                                   ],
                       "OverviewTile":  {
                                            "Id":  "SingleQueryDonutBuilderTileV1",
                                            "Type":  "OverviewTile",
                                            "Version":  2,
                                            "Configuration":  {
                                                                  "Donut":  {
                                                                                "Query":  "ITPC_CTX_Session_CL | where TimeGenerated \u003e ago(60m) | summarize AggregatedValue = dcount(SessionHash_s) by ConnectionState_s | sort by AggregatedValue desc\r\n// Oql: Type=ITPC_CTX_Session_CL  TimeGenerated\u003eNOW-60MINUTES | measure countdistinct(SessionHash_s) by ConnectionState_s",
                                                                                "CenterLegend":  {
                                                                                                     "Text":  "Active",
                                                                                                     "Operation":  "Sum",
                                                                                                     "ArcsToSelect":  [
                                                                                                                          "Active"
                                                                                                                      ]
                                                                                                 },
                                                                                "Options":  {
                                                                                                "colors":  [
                                                                                                               "#00188f",
                                                                                                               "#0072c6",
                                                                                                               "#00bcf2"
                                                                                                           ],
                                                                                                "valueColorMapping":  [

                                                                                                                      ],
                                                                                                "legend":  true,
                                                                                                "skipLegendPositioning":  true,
                                                                                                "center":  true,
                                                                                                "unitType":  "Count",
                                                                                                "fromUnit":  "Ones"
                                                                                            },
                                                                                "HideOtherLegend":  true
                                                                            },
                                                                  "Advanced":  {
                                                                                   "DataFlowVerification":  {
                                                                                                                "Enabled":  false,
                                                                                                                "Query":  "search *\r\n// Oql: *",
                                                                                                                "Message":  ""
                                                                                                            }
                                                                               }
                                                              }
                                        }
                   }
}
,
{
    "apiVersion":  "2015-11-01-preview",
    "name":  "Citrix Users",
    "type":  "views",
    "location":  "[parameters('location')]",
    "id":  "[Concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.OperationalInsights/workspaces/', parameters('workspace'),'/views/Citrix Users')]",
    "dependson":  [
                      "[Concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.OperationalInsights/workspaces/', parameters('workspace'))]"
                  ],
    "properties":  {
                       "Id":  "Citrix Users",
                       "Name":  "Citrix Site and Applications",
                       "Author":  "marcel.meurer@sepago.de",
                       "Source":  "Local",
                       "Version":  2,
                       "Dashboard":  [
                                         {
                                             "Id":  "NumberTileListBuilderBlade",
                                             "Type":  "Blade",
                                             "Version":  0,
                                             "Configuration":  {
                                                                   "General":  {
                                                                                   "title":  "Citrix Site",
                                                                                   "newGroup":  true,
                                                                                   "icon":  "",
                                                                                   "useIcon":  false
                                                                               },
                                                                   "Tile":  {
                                                                                "Legend":  "Unique User",
                                                                                "Query":  "ITPC_CTX_Session_CL | distinct UserName_s| count // Oql: Type=ITPC_CTX_Session_CL | distinct UserName_s",
                                                                                "NavigationSelect":  {

                                                                                                     }
                                                                            },
                                                                   "List":  {
                                                                                "Query":  "ITPC_CTX_PerfData_CL | summarize Count = dcount(UserName_s) by DesktopGroup_s// Oql: Type=ITPC_CTX_PerfData_CL  | measure countdistinct(UserName_s) as Count by DesktopGroup_s",
                                                                                "HideGraph":  false,
                                                                                "enableSparklines":  true,
                                                                                "ColumnsTitle":  {
                                                                                                     "Name":  "DesktopGroup",
                                                                                                     "Value":  "Count"
                                                                                                 },
                                                                                "Color":  "#0072c6",
                                                                                "thresholds":  {
                                                                                                   "isEnabled":  false,
                                                                                                   "values":  [
                                                                                                                  {
                                                                                                                      "name":  "Normal",
                                                                                                                      "threshold":  "Default",
                                                                                                                      "color":  "#009e49",
                                                                                                                      "isDefault":  true
                                                                                                                  },
                                                                                                                  {
                                                                                                                      "name":  "Warning",
                                                                                                                      "threshold":  "60",
                                                                                                                      "color":  "#fcd116",
                                                                                                                      "isDefault":  false
                                                                                                                  },
                                                                                                                  {
                                                                                                                      "name":  "Error",
                                                                                                                      "threshold":  "90",
                                                                                                                      "color":  "#ba141a",
                                                                                                                      "isDefault":  false
                                                                                                                  }
                                                                                                              ]
                                                                                               },
                                                                                "NameDSVSeparator":  "",
                                                                                "NavigationQuery":  "search {selected item} | sort by TimeGenerated desc",
                                                                                "NavigationSelect":  {
                                                                                                         "NavigationQuery":  "search {selected item} | sort by TimeGenerated desc"
                                                                                                     }
                                                                            }
                                                               }
                                         },
                                         {
                                             "Id":  "NumberTileListBuilderBlade",
                                             "Type":  "Blade",
                                             "Version":  0,
                                             "Configuration":  {
                                                                   "General":  {
                                                                                   "title":  "Applications",
                                                                                   "newGroup":  true,
                                                                                   "icon":  "",
                                                                                   "useIcon":  false
                                                                               },
                                                                   "Tile":  {
                                                                                "Query":  "ITPC_CTX_Application_CL | where Event_s == \"crashed\" | summarize AggregatedValue = count() by Name_s\r\n| count // Oql: Type=ITPC_CTX_Application_CL Event_s:\"crashed\"|measure count () by Name_s",
                                                                                "Legend":  "Application Crashed",
                                                                                "NavigationSelect":  {

                                                                                                     }
                                                                            },
                                                                   "List":  {
                                                                                "Query":  "ITPC_CTX_Application_CL | where Event_s == \"crashed\" | summarize AggregatedValue = count() by Name_s\r\n// Oql: Type=ITPC_CTX_Application_CL Event_s:\"crashed\"|measure count () by Name_s",
                                                                                "HideGraph":  false,
                                                                                "enableSparklines":  true,
                                                                                "operation":  "Summary",
                                                                                "ColumnsTitle":  {
                                                                                                     "Name":  "Application",
                                                                                                     "Value":  "Count"
                                                                                                 },
                                                                                "Color":  "#0072c6",
                                                                                "thresholds":  {
                                                                                                   "isEnabled":  false,
                                                                                                   "values":  [
                                                                                                                  {
                                                                                                                      "name":  "Normal",
                                                                                                                      "threshold":  "Default",
                                                                                                                      "color":  "#009e49",
                                                                                                                      "isDefault":  true
                                                                                                                  },
                                                                                                                  {
                                                                                                                      "name":  "Warning",
                                                                                                                      "threshold":  "60",
                                                                                                                      "color":  "#fcd116",
                                                                                                                      "isDefault":  false
                                                                                                                  },
                                                                                                                  {
                                                                                                                      "name":  "Error",
                                                                                                                      "threshold":  "90",
                                                                                                                      "color":  "#ba141a",
                                                                                                                      "isDefault":  false
                                                                                                                  }
                                                                                                              ]
                                                                                               },
                                                                                "NameDSVSeparator":  "",
                                                                                "NavigationQuery":  "ITPC_CTX_Application_CL | where Event_s == \"crashed\" | render table\r\n// Oql: Type=ITPC_CTX_Application_CL Event_s=crashed | display Table",
                                                                                "NavigationSelect":  {

                                                                                                     }
                                                                            }
                                                               }
                                         },
                                         {
                                             "Id":  "LineChartBuilderBlade",
                                             "Type":  "Blade",
                                             "Version":  0,
                                             "Configuration":  {
                                                                   "General":  {
                                                                                   "title":  "Application by User",
                                                                                   "newGroup":  true,
                                                                                   "icon":  "",
                                                                                   "useIcon":  false
                                                                               },
                                                                   "Header":  {
                                                                                  "Title":  "Processor usage",
                                                                                  "Subtitle":  "%"
                                                                              },
                                                                   "LineChart":  {
                                                                                     "Query":  "ITPC_CTX_PerfData_CL | where Category == \"Processor Information\" and Counter_s == \"% Processor Time\" | summarize AggregatedValue = avg(value_d) by Worker_s\r\n// Oql: Type=ITPC_CTX_PerfData_CL Category:\"Processor Information\" Counter_s:\"% Processor Time\"|measure avg(value_d) by Worker_s",
                                                                                     "yAxis":  {
                                                                                                   "isLogarithmic":  false,
                                                                                                   "units":  {
                                                                                                                 "baseUnitType":  "",
                                                                                                                 "baseUnit":  "",
                                                                                                                 "displayUnit":  ""
                                                                                                             },
                                                                                                   "customLabel":  ""
                                                                                               },
                                                                                     "NavigationSelect":  {

                                                                                                          }
                                                                                 },
                                                                   "List":  {
                                                                                "Query":  "ITPC_CTX_Process_CL | summarize AggregatedValue = avg(PercentProcessorTime_d) by UserName_s, Worker_s, Name_s\r\n// Oql: Type=ITPC_CTX_Process_CL  |measure avg(PercentProcessorTime_d) by UserName_s, Worker_s, Name_s",
                                                                                "HideGraph":  false,
                                                                                "enableSparklines":  true,
                                                                                "operation":  "Summary",
                                                                                "ColumnsTitle":  {
                                                                                                     "Name":  "Username",
                                                                                                     "Value":  "%"
                                                                                                 },
                                                                                "Color":  "#0072c6",
                                                                                "thresholds":  {
                                                                                                   "isEnabled":  false,
                                                                                                   "values":  [
                                                                                                                  {
                                                                                                                      "name":  "Normal",
                                                                                                                      "threshold":  "Default",
                                                                                                                      "color":  "#009e49",
                                                                                                                      "isDefault":  true
                                                                                                                  },
                                                                                                                  {
                                                                                                                      "name":  "Warning",
                                                                                                                      "threshold":  "60",
                                                                                                                      "color":  "#fcd116",
                                                                                                                      "isDefault":  false
                                                                                                                  },
                                                                                                                  {
                                                                                                                      "name":  "Error",
                                                                                                                      "threshold":  "90",
                                                                                                                      "color":  "#ba141a",
                                                                                                                      "isDefault":  false
                                                                                                                  }
                                                                                                              ]
                                                                                               },
                                                                                "NameDSVSeparator":  "",
                                                                                "NavigationQuery":  "search in (ITPC_CTX_Process_CL) {selected item} | summarize AggregatedValue = max(PercentProcessorTime_d) by UserName_s, Worker_s, Name_s, bin(TimeGenerated, 1h) | sort by TimeGenerated desc | render timechart\r\n// Oql: {selected item} Type=ITPC_CTX_Process_CL  |measure max(PercentProcessorTime_d) by UserName_s, Worker_s, Name_s | display linechart",
                                                                                "NavigationSelect":  {

                                                                                                     }
                                                                            }
                                                               }
                                         },
                                         {
                                             "Id":  "LineChartBuilderBlade",
                                             "Type":  "Blade",
                                             "Version":  0,
                                             "Configuration":  {
                                                                   "General":  {
                                                                                   "title":  "Application by User",
                                                                                   "newGroup":  false,
                                                                                   "icon":  "",
                                                                                   "useIcon":  false
                                                                               },
                                                                   "Header":  {
                                                                                  "Title":  "Memory available",
                                                                                  "Subtitle":  "Byte"
                                                                              },
                                                                   "LineChart":  {
                                                                                     "Query":  "ITPC_CTX_PerfData_CL | where Category == \"Memory\" and Counter_s == \"Available Bytes\" | summarize AggregatedValue = avg(value_d) by Worker_s\r\n// Oql: Type=ITPC_CTX_PerfData_CL Category:\"Memory\" Counter_s:\"Available Bytes\"|measure avg(value_d) by Worker_s",
                                                                                     "yAxis":  {
                                                                                                   "isLogarithmic":  false,
                                                                                                   "units":  {
                                                                                                                 "baseUnitType":  "",
                                                                                                                 "baseUnit":  "",
                                                                                                                 "displayUnit":  ""
                                                                                                             },
                                                                                                   "customLabel":  ""
                                                                                               },
                                                                                     "NavigationSelect":  {

                                                                                                          }
                                                                                 },
                                                                   "List":  {
                                                                                "Query":  "ITPC_CTX_Process_CL | summarize AggregatedValue = avg(WorkingSet_d) by UserName_s, Worker_s, Name_s\r\n// Oql: Type=ITPC_CTX_Process_CL  |measure avg(WorkingSet_d) by UserName_s, Worker_s, Name_s",
                                                                                "HideGraph":  false,
                                                                                "enableSparklines":  true,
                                                                                "operation":  "Summary",
                                                                                "ColumnsTitle":  {
                                                                                                     "Name":  "Username",
                                                                                                     "Value":  "Byte"
                                                                                                 },
                                                                                "Color":  "#0072c6",
                                                                                "thresholds":  {
                                                                                                   "isEnabled":  false,
                                                                                                   "values":  [
                                                                                                                  {
                                                                                                                      "name":  "Normal",
                                                                                                                      "threshold":  "Default",
                                                                                                                      "color":  "#009e49",
                                                                                                                      "isDefault":  true
                                                                                                                  },
                                                                                                                  {
                                                                                                                      "name":  "Warning",
                                                                                                                      "threshold":  "60",
                                                                                                                      "color":  "#fcd116",
                                                                                                                      "isDefault":  false
                                                                                                                  },
                                                                                                                  {
                                                                                                                      "name":  "Error",
                                                                                                                      "threshold":  "90",
                                                                                                                      "color":  "#ba141a",
                                                                                                                      "isDefault":  false
                                                                                                                  }
                                                                                                              ]
                                                                                               },
                                                                                "NameDSVSeparator":  "",
                                                                                "NavigationQuery":  "search in (ITPC_CTX_Process_CL) {selected item} | summarize AggregatedValue = max(WorkingSet_d) by UserName_s, Worker_s, Name_s, bin(TimeGenerated, 1h) | sort by TimeGenerated desc | render timechart\r\n// Oql: {selected item} Type=ITPC_CTX_Process_CL  |measure max(WorkingSet_d) by UserName_s, Worker_s, Name_s | display linechart",
                                                                                "NavigationSelect":  {

                                                                                                     }
                                                                            }
                                                               }
                                         },
                                         {
                                             "Id":  "SingleQueryDonutBuilderBladeV1",
                                             "Type":  "Blade",
                                             "Version":  0,
                                             "Configuration":  {
                                                                   "General":  {
                                                                                   "title":  "Application Overall Consumption",
                                                                                   "newGroup":  true,
                                                                                   "icon":  "",
                                                                                   "useIcon":  false
                                                                               },
                                                                   "Header":  {
                                                                                  "Title":  "Processor Consumption",
                                                                                  "Subtitle":  "Shared Ticks"
                                                                              },
                                                                   "Donut":  {
                                                                                 "Query":  "ITPC_CTX_Process_CL | where Name_s != \"System Idle Process\" | summarize AggregatedValue = sum(PercentProcessorTime_d) by Name_s | sort by AggregatedValue desc",
                                                                                 "CenterLegend":  {
                                                                                                      "Text":  "Total",
                                                                                                      "Operation":  "Sum",
                                                                                                      "ArcsToSelect":  [

                                                                                                                       ]
                                                                                                  },
                                                                                 "Options":  {
                                                                                                 "colors":  [
                                                                                                                "#00188f",
                                                                                                                "#0072c6",
                                                                                                                "#00bcf2"
                                                                                                            ],
                                                                                                 "valueColorMapping":  [

                                                                                                                       ]
                                                                                             },
                                                                                 "NavigationSelect":  {

                                                                                                      }
                                                                             },
                                                                   "List":  {
                                                                                "Query":  "ITPC_CTX_Process_CL | where Name_s != \"System Idle Process\" | summarize AggregatedValue = sum(PercentProcessorTime_d) by Name_s | sort by AggregatedValue desc ",
                                                                                "HideGraph":  false,
                                                                                "enableSparklines":  false,
                                                                                "operation":  "Summary",
                                                                                "ColumnsTitle":  {
                                                                                                     "Name":  "Process",
                                                                                                     "Value":  "S-Ticks"
                                                                                                 },
                                                                                "Color":  "#0072c6",
                                                                                "thresholds":  {
                                                                                                   "isEnabled":  false,
                                                                                                   "values":  [
                                                                                                                  {
                                                                                                                      "name":  "Normal",
                                                                                                                      "threshold":  "Default",
                                                                                                                      "color":  "#009e49",
                                                                                                                      "isDefault":  true
                                                                                                                  },
                                                                                                                  {
                                                                                                                      "name":  "Warning",
                                                                                                                      "threshold":  "60",
                                                                                                                      "color":  "#fcd116",
                                                                                                                      "isDefault":  false
                                                                                                                  },
                                                                                                                  {
                                                                                                                      "name":  "Error",
                                                                                                                      "threshold":  "90",
                                                                                                                      "color":  "#ba141a",
                                                                                                                      "isDefault":  false
                                                                                                                  }
                                                                                                              ]
                                                                                               },
                                                                                "NameDSVSeparator":  "",
                                                                                "NavigationQuery":  "ITPC_CTX_Process_CL | where Name_s != \"System Idle Process\" and {selected item}| summarize AggregatedValue = sum(PercentProcessorTime_d)  by UserName_s",
                                                                                "NavigationSelect":  {
                                                                                                         "NavigationQuery":  "ITPC_CTX_Process_CL | where Name_s != \"System Idle Process\" and {selected item}| summarize AggregatedValue = sum(PercentProcessorTime_d)  by UserName_s"
                                                                                                     }
                                                                            }
                                                               }
                                         },
                                         {
                                             "Id":  "SingleQueryDonutBuilderBladeV1",
                                             "Type":  "Blade",
                                             "Version":  0,
                                             "Configuration":  {
                                                                   "General":  {
                                                                                   "title":  "Application Overall Consumption",
                                                                                   "newGroup":  false,
                                                                                   "icon":  "",
                                                                                   "useIcon":  false
                                                                               },
                                                                   "Header":  {
                                                                                  "Title":  "Memory Consumption",
                                                                                  "Subtitle":  "Memory Ticks"
                                                                              },
                                                                   "Donut":  {
                                                                                 "Query":  "ITPC_CTX_Process_CL | where Name_s != \"System Idle Process\" | extend WorkingSetN = (WorkingSet_d * 0.0000000001) | summarize AggregatedValue = sum(WorkingSetN) by Name_s | sort by AggregatedValue desc",
                                                                                 "CenterLegend":  {
                                                                                                      "Text":  "Total",
                                                                                                      "Operation":  "Sum",
                                                                                                      "ArcsToSelect":  [

                                                                                                                       ]
                                                                                                  },
                                                                                 "Options":  {
                                                                                                 "colors":  [
                                                                                                                "#00188f",
                                                                                                                "#0072c6",
                                                                                                                "#00bcf2"
                                                                                                            ],
                                                                                                 "valueColorMapping":  [

                                                                                                                       ]
                                                                                             },
                                                                                 "NavigationSelect":  {

                                                                                                      }
                                                                             },
                                                                   "List":  {
                                                                                "Query":  "ITPC_CTX_Process_CL | where Name_s != \"System Idle Process\" | extend WorkingSetN = (WorkingSet_d * 0.0000000001) | summarize AggregatedValue = sum(WorkingSetN) by Name_s | order by AggregatedValue desc ",
                                                                                "HideGraph":  false,
                                                                                "enableSparklines":  false,
                                                                                "operation":  "Summary",
                                                                                "ColumnsTitle":  {
                                                                                                     "Name":  "Process",
                                                                                                     "Value":  "M-nTicks"
                                                                                                 },
                                                                                "Color":  "#0072c6",
                                                                                "thresholds":  {
                                                                                                   "isEnabled":  false,
                                                                                                   "values":  [
                                                                                                                  {
                                                                                                                      "name":  "Normal",
                                                                                                                      "threshold":  "Default",
                                                                                                                      "color":  "#009e49",
                                                                                                                      "isDefault":  true
                                                                                                                  },
                                                                                                                  {
                                                                                                                      "name":  "Warning",
                                                                                                                      "threshold":  "60",
                                                                                                                      "color":  "#fcd116",
                                                                                                                      "isDefault":  false
                                                                                                                  },
                                                                                                                  {
                                                                                                                      "name":  "Error",
                                                                                                                      "threshold":  "90",
                                                                                                                      "color":  "#ba141a",
                                                                                                                      "isDefault":  false
                                                                                                                  }
                                                                                                              ]
                                                                                               },
                                                                                "NameDSVSeparator":  "",
                                                                                "NavigationQuery":  "ITPC_CTX_Process_CL | where Name_s != \"System Idle Process\"   and {selected item} | extend WorkingSetN = (WorkingSet_d * 0.0000000001) | summarize AggregatedValue = sum(WorkingSetN) by UserName_s",
                                                                                "NavigationSelect":  {
                                                                                                         "NavigationQuery":  "ITPC_CTX_Process_CL | where Name_s != \"System Idle Process\"   and {selected item} | extend WorkingSetN = (WorkingSet_d * 0.0000000001) | summarize AggregatedValue = sum(WorkingSetN) by UserName_s"
                                                                                                     }
                                                                            }
                                                               }
                                         },
                                         {
                                             "Id":  "SingleQueryDonutBuilderBladeV1",
                                             "Type":  "Blade",
                                             "Version":  0,
                                             "Configuration":  {
                                                                   "General":  {
                                                                                   "title":  "User Overall Consumption",
                                                                                   "newGroup":  true,
                                                                                   "icon":  "",
                                                                                   "useIcon":  false
                                                                               },
                                                                   "Header":  {
                                                                                  "Title":  "Processor Consumption",
                                                                                  "Subtitle":  "Shared Ticks"
                                                                              },
                                                                   "Donut":  {
                                                                                 "Query":  "ITPC_CTX_Process_CL | where UserName_s != \"\" and Name_s != \"System Idle Process\" | summarize AggregatedValue = sum(PercentProcessorTime_d) by UserName_s | order by AggregatedValue desc",
                                                                                 "CenterLegend":  {
                                                                                                      "Text":  "Total",
                                                                                                      "Operation":  "Sum",
                                                                                                      "ArcsToSelect":  [

                                                                                                                       ]
                                                                                                  },
                                                                                 "Options":  {
                                                                                                 "colors":  [
                                                                                                                "#00188f",
                                                                                                                "#0072c6",
                                                                                                                "#00bcf2"
                                                                                                            ],
                                                                                                 "valueColorMapping":  [

                                                                                                                       ]
                                                                                             },
                                                                                 "NavigationSelect":  {

                                                                                                      }
                                                                             },
                                                                   "List":  {
                                                                                "Query":  "ITPC_CTX_Process_CL | where UserName_s != \"\" and Name_s != \"System Idle Process\" | summarize AggregatedValue = sum(PercentProcessorTime_d) by UserName_s | order by AggregatedValue desc",
                                                                                "HideGraph":  false,
                                                                                "enableSparklines":  false,
                                                                                "operation":  "Summary",
                                                                                "ColumnsTitle":  {
                                                                                                     "Name":  "Process",
                                                                                                     "Value":  "S-Ticks"
                                                                                                 },
                                                                                "Color":  "#0072c6",
                                                                                "thresholds":  {
                                                                                                   "isEnabled":  false,
                                                                                                   "values":  [
                                                                                                                  {
                                                                                                                      "name":  "Normal",
                                                                                                                      "threshold":  "Default",
                                                                                                                      "color":  "#009e49",
                                                                                                                      "isDefault":  true
                                                                                                                  },
                                                                                                                  {
                                                                                                                      "name":  "Warning",
                                                                                                                      "threshold":  "60",
                                                                                                                      "color":  "#fcd116",
                                                                                                                      "isDefault":  false
                                                                                                                  },
                                                                                                                  {
                                                                                                                      "name":  "Error",
                                                                                                                      "threshold":  "90",
                                                                                                                      "color":  "#ba141a",
                                                                                                                      "isDefault":  false
                                                                                                                  }
                                                                                                              ]
                                                                                               },
                                                                                "NameDSVSeparator":  "",
                                                                                "NavigationQuery":  "ITPC_CTX_Process_CL | where UserName_s != \"\" and Name_s != \"System Idle Process\" and {selected item}| summarize AggregatedValue = sum(PercentProcessorTime_d) by Name_s",
                                                                                "NavigationSelect":  {
                                                                                                         "NavigationQuery":  "ITPC_CTX_Process_CL | where UserName_s != \"\" and Name_s != \"System Idle Process\" and {selected item}| summarize AggregatedValue = sum(PercentProcessorTime_d) by Name_s"
                                                                                                     }
                                                                            }
                                                               }
                                         },
                                         {
                                             "Id":  "SingleQueryDonutBuilderBladeV1",
                                             "Type":  "Blade",
                                             "Version":  0,
                                             "Configuration":  {
                                                                   "General":  {
                                                                                   "title":  "User OVERALL CONSUMPTION",
                                                                                   "newGroup":  false,
                                                                                   "icon":  "",
                                                                                   "useIcon":  false
                                                                               },
                                                                   "Header":  {
                                                                                  "Title":  "Memory Consumption",
                                                                                  "Subtitle":  "Memory Ticks"
                                                                              },
                                                                   "Donut":  {
                                                                                 "Query":  "ITPC_CTX_Process_CL | where UserName_s != \"\" and Name_s != \"System Idle Process\" | extend WorkingSetN = (WorkingSet_d * 0.0000000001) | summarize AggregatedValue = sum(WorkingSetN) by UserName_s | sort by AggregatedValue desc",
                                                                                 "CenterLegend":  {
                                                                                                      "Text":  "Total",
                                                                                                      "Operation":  "Sum",
                                                                                                      "ArcsToSelect":  [

                                                                                                                       ]
                                                                                                  },
                                                                                 "Options":  {
                                                                                                 "colors":  [
                                                                                                                "#00188f",
                                                                                                                "#0072c6",
                                                                                                                "#00bcf2"
                                                                                                            ],
                                                                                                 "valueColorMapping":  [

                                                                                                                       ]
                                                                                             },
                                                                                 "NavigationSelect":  {

                                                                                                      }
                                                                             },
                                                                   "List":  {
                                                                                "Query":  "ITPC_CTX_Process_CL | where UserName_s != \"\" and Name_s != \"System Idle Process\" | extend WorkingSetN = (WorkingSet_d * 0.0000000001) | summarize AggregatedValue = sum(WorkingSetN) by UserName_s | order by AggregatedValue desc",
                                                                                "HideGraph":  false,
                                                                                "enableSparklines":  false,
                                                                                "operation":  "Summary",
                                                                                "ColumnsTitle":  {
                                                                                                     "Name":  "Process",
                                                                                                     "Value":  "M-nTicks"
                                                                                                 },
                                                                                "Color":  "#0072c6",
                                                                                "thresholds":  {
                                                                                                   "isEnabled":  false,
                                                                                                   "values":  [
                                                                                                                  {
                                                                                                                      "name":  "Normal",
                                                                                                                      "threshold":  "Default",
                                                                                                                      "color":  "#009e49",
                                                                                                                      "isDefault":  true
                                                                                                                  },
                                                                                                                  {
                                                                                                                      "name":  "Warning",
                                                                                                                      "threshold":  "60",
                                                                                                                      "color":  "#fcd116",
                                                                                                                      "isDefault":  false
                                                                                                                  },
                                                                                                                  {
                                                                                                                      "name":  "Error",
                                                                                                                      "threshold":  "90",
                                                                                                                      "color":  "#ba141a",
                                                                                                                      "isDefault":  false
                                                                                                                  }
                                                                                                              ]
                                                                                               },
                                                                                "NameDSVSeparator":  "",
                                                                                "NavigationQuery":  "ITPC_CTX_Process_CL | where UserName_s != \"\" and Name_s != \"System Idle Process\" and {selected item}| extend WorkingSetN = (WorkingSet_d * 0.0000000001) | summarize AggregatedValue = sum(WorkingSetN) by Name_s",
                                                                                "NavigationSelect":  {
                                                                                                         "NavigationQuery":  "ITPC_CTX_Process_CL | where UserName_s != \"\" and Name_s != \"System Idle Process\" and {selected item}| extend WorkingSetN = (WorkingSet_d * 0.0000000001) | summarize AggregatedValue = sum(WorkingSetN) by Name_s"
                                                                                                     }
                                                                            }
                                                               }
                                         }
                                     ],
                       "Filters":  [

                                   ],
                       "OverviewTile":  {
                                            "Id":  "SingleNumberBuilderTile",
                                            "Type":  "OverviewTile",
                                            "Version":  2,
                                            "Configuration":  {
                                                                  "Tile":  {
                                                                               "Legend":  "Unique Users",
                                                                               "Query":  "ITPC_CTX_Process_CL | distinct UserName_s\r\n| count // Oql: Type=ITPC_CTX_Process_CL | distinct UserName_s"
                                                                           },
                                                                  "Advanced":  {
                                                                                   "DataFlowVerification":  {
                                                                                                                "Enabled":  false,
                                                                                                                "Query":  "search *\r\n// Oql: *",
                                                                                                                "Message":  ""
                                                                                                            }
                                                                               }
                                                              }
                                        }
                   }
}
,
{
    "apiVersion":  "2015-11-01-preview",
    "name":  "Citrix Workers",
    "type":  "views",
    "location":  "[parameters('location')]",
    "id":  "[Concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.OperationalInsights/workspaces/', parameters('workspace'),'/views/Citrix Workers')]",
    "dependson":  [
                      "[Concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.OperationalInsights/workspaces/', parameters('workspace'))]"
                  ],
    "properties":  {
                       "Id":  "Citrix Workers",
                       "Name":  "Citrix Workers",
                       "Author":  "marcel.meurer@sepago.de",
                       "Source":  "Local",
                       "Version":  2,
                       "Dashboard":  [
                                         {
                                             "Id":  "LineChartCalloutBuilderBlade",
                                             "Type":  "Blade",
                                             "Version":  0,
                                             "Configuration":  {
                                                                   "General":  {
                                                                                   "title":  "CPU Consumption",
                                                                                   "newGroup":  false,
                                                                                   "icon":  "",
                                                                                   "useIcon":  false
                                                                               },
                                                                   "Header":  {
                                                                                  "Title":  "Overall CPU Consumption",
                                                                                  "Subtitle":  "%"
                                                                              },
                                                                   "LineChart":  {
                                                                                     "Query":  "ITPC_CTX_PerfData_CL | where Category == \"Processor Information\" and Counter_s == \"% Processor Time\" | summarize AggregatedValue = avg(value_d) by Worker_s, bin(TimeGenerated, 1h) | sort by TimeGenerated desc | render timechart// Oql: Type=ITPC_CTX_PerfData_CL Category:\"Processor Information\" Counter_s:\"% Processor Time\"  | measure avg(value_d) by Worker_s | display LineChart",
                                                                                     "Callout":  {
                                                                                                     "Title":  "Avg",
                                                                                                     "Series":  "",
                                                                                                     "Operation":  "Average"
                                                                                                 },
                                                                                     "yAxis":  {
                                                                                                   "isLogarithmic":  false,
                                                                                                   "units":  {
                                                                                                                 "baseUnitType":  "",
                                                                                                                 "baseUnit":  "",
                                                                                                                 "displayUnit":  ""
                                                                                                             },
                                                                                                   "customLabel":  ""
                                                                                               },
                                                                                     "NavigationSelect":  {

                                                                                                          }
                                                                                 },
                                                                   "List":  {
                                                                                "Query":  "ITPC_CTX_PerfData_CL | where Category == \"Processor Information\" and Counter_s == \"% Processor Time\" | summarize AggregatedValue = avg(value_d) by Worker_s | sort by Worker_s asc// Oql: Type=ITPC_CTX_PerfData_CL Category:\"Processor Information\" Counter_s:\"% Processor Time\"  | measure avg(value_d) by Worker_s | sort Worker_s",
                                                                                "HideGraph":  false,
                                                                                "enableSparklines":  true,
                                                                                "ColumnsTitle":  {
                                                                                                     "Name":  "Worker",
                                                                                                     "Value":  "%"
                                                                                                 },
                                                                                "Color":  "#0072c6",
                                                                                "thresholds":  {
                                                                                                   "isEnabled":  true,
                                                                                                   "values":  [
                                                                                                                  {
                                                                                                                      "name":  "Normal",
                                                                                                                      "threshold":  "Default",
                                                                                                                      "color":  "#009e49",
                                                                                                                      "isDefault":  true
                                                                                                                  },
                                                                                                                  {
                                                                                                                      "name":  "Warning",
                                                                                                                      "threshold":  "85",
                                                                                                                      "color":  "#fcd116",
                                                                                                                      "isDefault":  false
                                                                                                                  },
                                                                                                                  {
                                                                                                                      "name":  "Error",
                                                                                                                      "threshold":  "92",
                                                                                                                      "color":  "#ba141a",
                                                                                                                      "isDefault":  false
                                                                                                                  }
                                                                                                              ]
                                                                                               },
                                                                                "NameDSVSeparator":  "",
                                                                                "NavigationQuery":  "search {selected item} | sort by TimeGenerated desc",
                                                                                "NavigationSelect":  {
                                                                                                         "NavigationQuery":  "search {selected item} | sort by TimeGenerated desc"
                                                                                                     }
                                                                            }
                                                               }
                                         },
                                         {
                                             "Id":  "LineChartCalloutBuilderBlade",
                                             "Type":  "Blade",
                                             "Version":  0,
                                             "Configuration":  {
                                                                   "General":  {
                                                                                   "title":  "Memory Consumption",
                                                                                   "newGroup":  false,
                                                                                   "icon":  "",
                                                                                   "useIcon":  false
                                                                               },
                                                                   "Header":  {
                                                                                  "Title":  "Memory free",
                                                                                  "Subtitle":  "Availaible bytes"
                                                                              },
                                                                   "LineChart":  {
                                                                                     "Query":  "ITPC_CTX_PerfData_CL | where Category == \"Memory\" and Counter_s == \"Available Bytes\" | summarize AggregatedValue = avg(value_d) by Worker_s, bin(TimeGenerated, 1h) | sort by TimeGenerated desc | render timechart\r\n// Oql: Type=ITPC_CTX_PerfData_CL Category:\"Memory\" Counter_s:\"Available Bytes\"  | measure avg(value_d) by Worker_s | display LineChart",
                                                                                     "Callout":  {
                                                                                                     "Title":  "Avg",
                                                                                                     "Series":  "",
                                                                                                     "Operation":  "Average"
                                                                                                 },
                                                                                     "yAxis":  {
                                                                                                   "isLogarithmic":  false,
                                                                                                   "units":  {
                                                                                                                 "baseUnitType":  "",
                                                                                                                 "baseUnit":  "",
                                                                                                                 "displayUnit":  ""
                                                                                                             },
                                                                                                   "customLabel":  ""
                                                                                               },
                                                                                     "NavigationSelect":  {

                                                                                                          }
                                                                                 },
                                                                   "List":  {
                                                                                "Query":  "ITPC_CTX_PerfData_CL | where Category == \"Memory\" and Counter_s == \"Available Bytes\" | summarize AggregatedValue = avg(value_d) by Worker_s | sort by Worker_s asc\r\n// Oql: Type=ITPC_CTX_PerfData_CL Category:\"Memory\" Counter_s:\"Available Bytes\"  | measure avg(value_d) by Worker_s  | sort Worker_s",
                                                                                "HideGraph":  false,
                                                                                "enableSparklines":  true,
                                                                                "operation":  "Summary",
                                                                                "ColumnsTitle":  {
                                                                                                     "Name":  "Worker",
                                                                                                     "Value":  "Bytes free"
                                                                                                 },
                                                                                "Color":  "#0072c6",
                                                                                "thresholds":  {
                                                                                                   "isEnabled":  true,
                                                                                                   "values":  [
                                                                                                                  {
                                                                                                                      "name":  "Error",
                                                                                                                      "threshold":  "Default",
                                                                                                                      "color":  "#ba141a",
                                                                                                                      "isDefault":  true
                                                                                                                  },
                                                                                                                  {
                                                                                                                      "name":  "Warning",
                                                                                                                      "threshold":  "100000000",
                                                                                                                      "color":  "#fcd116",
                                                                                                                      "isDefault":  false
                                                                                                                  },
                                                                                                                  {
                                                                                                                      "name":  "Normal",
                                                                                                                      "threshold":  "1000000000",
                                                                                                                      "color":  "#009e49",
                                                                                                                      "isDefault":  false
                                                                                                                  }
                                                                                                              ]
                                                                                               },
                                                                                "NameDSVSeparator":  "",
                                                                                "NavigationQuery":  "search in (ITPC_CTX_Process_CL) {selected item} and Name_s != \"System Idle Process\" | summarize Memory_Byte = avg(WorkingSet_d) by Name_s, bin(TimeGenerated, 1h) | sort by TimeGenerated desc | render timechart\r\n// Oql: {selected item} Type=ITPC_CTX_Process_CL not Name_s:\"System Idle Process\"| measure avg(WorkingSet_d) as Memory_Byte by Name_s | display LineChart",
                                                                                "NavigationSelect":  {

                                                                                                     }
                                                                            }
                                                               }
                                         },
                                         {
                                             "Id":  "LineChartCalloutBuilderBlade",
                                             "Type":  "Blade",
                                             "Version":  0,
                                             "Configuration":  {
                                                                   "General":  {
                                                                                   "title":  "Network",
                                                                                   "newGroup":  false,
                                                                                   "icon":  "",
                                                                                   "useIcon":  false
                                                                               },
                                                                   "Header":  {
                                                                                  "Title":  "Network Throughput",
                                                                                  "Subtitle":  "byte/s"
                                                                              },
                                                                   "LineChart":  {
                                                                                     "Query":  "ITPC_CTX_PerfData_CL | where Category == \"Network Adapter\" and Counter_s == \"Bytes Total/sec\" | summarize AggregatedValue = avg(value_d) by Worker_s, bin(TimeGenerated, 1h) | sort by TimeGenerated desc | render timechart\r\n// Oql: Type=ITPC_CTX_PerfData_CL Category:\"Network Adapter\"  Counter_s:\"Bytes Total/sec\" | measure avg(value_d) by Worker_s | display LineChart",
                                                                                     "Callout":  {
                                                                                                     "Title":  "Avg",
                                                                                                     "Series":  "",
                                                                                                     "Operation":  "Average"
                                                                                                 },
                                                                                     "yAxis":  {
                                                                                                   "isLogarithmic":  false,
                                                                                                   "units":  {
                                                                                                                 "baseUnitType":  "",
                                                                                                                 "baseUnit":  "",
                                                                                                                 "displayUnit":  ""
                                                                                                             },
                                                                                                   "customLabel":  ""
                                                                                               },
                                                                                     "NavigationSelect":  {

                                                                                                          }
                                                                                 },
                                                                   "List":  {
                                                                                "Query":  "ITPC_CTX_PerfData_CL | where Category == \"Network Adapter\" and Counter_s == \"Bytes Total/sec\" | summarize AggregatedValue = avg(value_d) by Worker_s\r\n// Oql: Type=ITPC_CTX_PerfData_CL Category:\"Network Adapter\"  Counter_s:\"Bytes Total/sec\" | measure avg(value_d) by Worker_s",
                                                                                "HideGraph":  false,
                                                                                "enableSparklines":  true,
                                                                                "operation":  "Summary",
                                                                                "ColumnsTitle":  {
                                                                                                     "Name":  "Worker",
                                                                                                     "Value":  "byte/s"
                                                                                                 },
                                                                                "Color":  "#0072c6",
                                                                                "thresholds":  {
                                                                                                   "isEnabled":  true,
                                                                                                   "values":  [
                                                                                                                  {
                                                                                                                      "name":  "Normal",
                                                                                                                      "threshold":  "Default",
                                                                                                                      "color":  "#009e49",
                                                                                                                      "isDefault":  true
                                                                                                                  },
                                                                                                                  {
                                                                                                                      "name":  "Warning",
                                                                                                                      "threshold":  "2000000",
                                                                                                                      "color":  "#fcd116",
                                                                                                                      "isDefault":  false
                                                                                                                  },
                                                                                                                  {
                                                                                                                      "name":  "Error",
                                                                                                                      "threshold":  "10000000",
                                                                                                                      "color":  "#ba141a",
                                                                                                                      "isDefault":  false
                                                                                                                  }
                                                                                                              ]
                                                                                               },
                                                                                "NameDSVSeparator":  "",
                                                                                "NavigationQuery":  "search in (ITPC_CTX_Process_CL) {selected item} and Name_s != \"System Idle Process\" | summarize IO_BpS = avg(IODataBytesPersec_d) by Name_s, bin(TimeGenerated, 1h) | sort by TimeGenerated desc | render timechart\r\n// Oql: {selected item} Type=ITPC_CTX_Process_CL not Name_s:\"System Idle Process\"| measure avg(IODataBytesPersec_d) as IO_BpS  by Name_s | display LineChart",
                                                                                "NavigationSelect":  {

                                                                                                     }
                                                                            }
                                                               }
                                         },
                                         {
                                             "Id":  "LineChartCalloutBuilderBlade",
                                             "Type":  "Blade",
                                             "Version":  0,
                                             "Configuration":  {
                                                                   "General":  {
                                                                                   "title":  "Processor Queue",
                                                                                   "newGroup":  false,
                                                                                   "icon":  "",
                                                                                   "useIcon":  false
                                                                               },
                                                                   "Header":  {
                                                                                  "Title":  "Length",
                                                                                  "Subtitle":  "#"
                                                                              },
                                                                   "LineChart":  {
                                                                                     "Query":  "ITPC_CTX_PerfData_CL | where Category == \"System\" and Counter_s == \"Processor Queue Length\" | summarize AggregatedValue = avg(value_d) by Worker_s, bin(TimeGenerated, 1h) | sort by TimeGenerated desc | render timechart\r\n// Oql: Type=ITPC_CTX_PerfData_CL Category:\"System\" Counter_s:\"Processor Queue Length\"   | measure avg(value_d) by Worker_s  | display LineChart",
                                                                                     "Callout":  {
                                                                                                     "Title":  "Avg",
                                                                                                     "Series":  "",
                                                                                                     "Operation":  "Average"
                                                                                                 },
                                                                                     "yAxis":  {
                                                                                                   "isLogarithmic":  false,
                                                                                                   "units":  {
                                                                                                                 "baseUnitType":  "",
                                                                                                                 "baseUnit":  "",
                                                                                                                 "displayUnit":  ""
                                                                                                             },
                                                                                                   "customLabel":  ""
                                                                                               },
                                                                                     "NavigationSelect":  {

                                                                                                          }
                                                                                 },
                                                                   "List":  {
                                                                                "Query":  "ITPC_CTX_PerfData_CL | where Category == \"System\" and Counter_s == \"Processor Queue Length\" | summarize AggregatedValue = avg(value_d) by Worker_s | sort by Worker_s asc\r\n// Oql: Type=ITPC_CTX_PerfData_CL Category:\"System\" Counter_s:\"Processor Queue Length\"   | measure avg(value_d) by Worker_s  | sort Worker_s",
                                                                                "HideGraph":  false,
                                                                                "enableSparklines":  true,
                                                                                "operation":  "Summary",
                                                                                "ColumnsTitle":  {
                                                                                                     "Name":  "Worker",
                                                                                                     "Value":  "#"
                                                                                                 },
                                                                                "Color":  "#0072c6",
                                                                                "thresholds":  {
                                                                                                   "isEnabled":  true,
                                                                                                   "values":  [
                                                                                                                  {
                                                                                                                      "name":  "Normal",
                                                                                                                      "threshold":  "Default",
                                                                                                                      "color":  "#009e49",
                                                                                                                      "isDefault":  true
                                                                                                                  },
                                                                                                                  {
                                                                                                                      "name":  "Warning",
                                                                                                                      "threshold":  "6",
                                                                                                                      "color":  "#fcd116",
                                                                                                                      "isDefault":  false
                                                                                                                  },
                                                                                                                  {
                                                                                                                      "name":  "Error",
                                                                                                                      "threshold":  "12",
                                                                                                                      "color":  "#ba141a",
                                                                                                                      "isDefault":  false
                                                                                                                  }
                                                                                                              ]
                                                                                               },
                                                                                "NameDSVSeparator":  "",
                                                                                "NavigationQuery":  "search in (ITPC_CTX_Process_CL) {selected item} and Name_s != \"System Idle Process\" | summarize CPU_Perc = avg(PercentProcessorTime_d), Mem_Byte = avg(WorkingSet_d) by Name_s\r\n// Oql: {selected item}   Type=ITPC_CTX_Process_CL not Name_s:\"System Idle Process\"| measure avg(PercentProcessorTime_d) as CPU_Perc,  avg(WorkingSet_d)  as Mem_Byte by Name_s",
                                                                                "NavigationSelect":  {

                                                                                                     }
                                                                            }
                                                               }
                                         },
                                         {
                                             "Id":  "LineChartCalloutBuilderBlade",
                                             "Type":  "Blade",
                                             "Version":  0,
                                             "Configuration":  {
                                                                   "General":  {
                                                                                   "title":  "Disk Queue",
                                                                                   "newGroup":  false,
                                                                                   "icon":  "",
                                                                                   "useIcon":  false
                                                                               },
                                                                   "Header":  {
                                                                                  "Title":  "Length",
                                                                                  "Subtitle":  "#"
                                                                              },
                                                                   "LineChart":  {
                                                                                     "Query":  "ITPC_CTX_PerfData_CL | where Category == \"PhysicalDisk\" and Counter_s == \"Avg. Disk Queue Length\" and Instance_s == \"_Total\" | summarize AggregatedValue = avg(value_d) by Worker_s, bin(TimeGenerated, 1h) | sort by TimeGenerated desc | render timechart\r\n// Oql: Type=ITPC_CTX_PerfData_CL Category:\"PhysicalDisk\" Counter_s:\"Avg. Disk Queue Length\" Instance_s:\"_Total\"  | measure avg(value_d) by Worker_s | display LineChart",
                                                                                     "Callout":  {
                                                                                                     "Title":  "Avg",
                                                                                                     "Series":  "",
                                                                                                     "Operation":  "Average"
                                                                                                 },
                                                                                     "yAxis":  {
                                                                                                   "isLogarithmic":  false,
                                                                                                   "units":  {
                                                                                                                 "baseUnitType":  "",
                                                                                                                 "baseUnit":  "",
                                                                                                                 "displayUnit":  ""
                                                                                                             },
                                                                                                   "customLabel":  ""
                                                                                               },
                                                                                     "NavigationSelect":  {

                                                                                                          }
                                                                                 },
                                                                   "List":  {
                                                                                "Query":  "ITPC_CTX_PerfData_CL | where Category == \"PhysicalDisk\" and Counter_s == \"Avg. Disk Queue Length\" and Instance_s == \"_Total\" | summarize AggregatedValue = avg(value_d) by Worker_s | sort by Worker_s asc\r\n// Oql: Type=ITPC_CTX_PerfData_CL Category:\"PhysicalDisk\" Counter_s:\"Avg. Disk Queue Length\" Instance_s:\"_Total\"  | measure avg(value_d) by Worker_s  | sort Worker_s",
                                                                                "HideGraph":  false,
                                                                                "enableSparklines":  true,
                                                                                "operation":  "Summary",
                                                                                "ColumnsTitle":  {
                                                                                                     "Name":  "Worker",
                                                                                                     "Value":  "#"
                                                                                                 },
                                                                                "Color":  "#0072c6",
                                                                                "thresholds":  {
                                                                                                   "isEnabled":  true,
                                                                                                   "values":  [
                                                                                                                  {
                                                                                                                      "name":  "Normal",
                                                                                                                      "threshold":  "Default",
                                                                                                                      "color":  "#009e49",
                                                                                                                      "isDefault":  true
                                                                                                                  },
                                                                                                                  {
                                                                                                                      "name":  "Warning",
                                                                                                                      "threshold":  "0.8",
                                                                                                                      "color":  "#fcd116",
                                                                                                                      "isDefault":  false
                                                                                                                  },
                                                                                                                  {
                                                                                                                      "name":  "Error",
                                                                                                                      "threshold":  "1.8",
                                                                                                                      "color":  "#ba141a",
                                                                                                                      "isDefault":  false
                                                                                                                  }
                                                                                                              ]
                                                                                               },
                                                                                "NameDSVSeparator":  "",
                                                                                "NavigationQuery":  "search in (ITPC_CTX_Process_CL) {selected item} and Name_s != \"System Idle Process\" | summarize IO_BpS = avg(IODataBytesPersec_d) by Name_s, bin(TimeGenerated, 1h) | sort by TimeGenerated desc | render timechart\r\n// Oql: {selected item} Type=ITPC_CTX_Process_CL not Name_s:\"System Idle Process\"| measure avg(IODataBytesPersec_d) as IO_BpS  by Name_s | display LineChart",
                                                                                "NavigationSelect":  {

                                                                                                     }
                                                                            }
                                                               }
                                         },
                                         {
                                             "Id":  "LineChartCalloutBuilderBlade",
                                             "Type":  "Blade",
                                             "Version":  0,
                                             "Configuration":  {
                                                                   "General":  {
                                                                                   "title":  "Paging File",
                                                                                   "newGroup":  false,
                                                                                   "icon":  "",
                                                                                   "useIcon":  false
                                                                               },
                                                                   "Header":  {
                                                                                  "Title":  "Usage",
                                                                                  "Subtitle":  "%"
                                                                              },
                                                                   "LineChart":  {
                                                                                     "Query":  "ITPC_CTX_PerfData_CL | where Category == \"Paging File\" and Counter_s == \"% Usage\" and Instance_s == \"_Total\" | summarize AggregatedValue = avg(value_d) by Worker_s, bin(TimeGenerated, 1h) | sort by TimeGenerated desc | render timechart\r\n// Oql: Type=ITPC_CTX_PerfData_CL Category:\"Paging File\" Counter_s:\"% Usage\" Instance_s:\"_Total\"  | measure avg(value_d) by Worker_s | display LineChart",
                                                                                     "Callout":  {
                                                                                                     "Title":  "Avg",
                                                                                                     "Series":  "",
                                                                                                     "Operation":  "Average"
                                                                                                 },
                                                                                     "yAxis":  {
                                                                                                   "isLogarithmic":  false,
                                                                                                   "units":  {
                                                                                                                 "baseUnitType":  "",
                                                                                                                 "baseUnit":  "",
                                                                                                                 "displayUnit":  ""
                                                                                                             },
                                                                                                   "customLabel":  ""
                                                                                               },
                                                                                     "NavigationSelect":  {

                                                                                                          }
                                                                                 },
                                                                   "List":  {
                                                                                "Query":  "ITPC_CTX_PerfData_CL | where Category == \"Paging File\" and Counter_s == \"% Usage\" and Instance_s == \"_Total\" | summarize AggregatedValue = avg(value_d) by Worker_s | sort by Worker_s asc\r\n// Oql: Type=ITPC_CTX_PerfData_CL Category:\"Paging File\" Counter_s:\"% Usage\" Instance_s:\"_Total\"  | measure avg(value_d) by Worker_s  | sort Worker_s",
                                                                                "HideGraph":  false,
                                                                                "enableSparklines":  true,
                                                                                "operation":  "Summary",
                                                                                "ColumnsTitle":  {
                                                                                                     "Name":  "Worker",
                                                                                                     "Value":  "%"
                                                                                                 },
                                                                                "Color":  "#0072c6",
                                                                                "thresholds":  {
                                                                                                   "isEnabled":  true,
                                                                                                   "values":  [
                                                                                                                  {
                                                                                                                      "name":  "Normal",
                                                                                                                      "threshold":  "Default",
                                                                                                                      "color":  "#009e49",
                                                                                                                      "isDefault":  true
                                                                                                                  },
                                                                                                                  {
                                                                                                                      "name":  "Warning",
                                                                                                                      "threshold":  "70",
                                                                                                                      "color":  "#fcd116",
                                                                                                                      "isDefault":  false
                                                                                                                  },
                                                                                                                  {
                                                                                                                      "name":  "Error",
                                                                                                                      "threshold":  "90",
                                                                                                                      "color":  "#ba141a",
                                                                                                                      "isDefault":  false
                                                                                                                  }
                                                                                                              ]
                                                                                               },
                                                                                "NameDSVSeparator":  "",
                                                                                "NavigationQuery":  "search {selected item}\r\n// Oql: {selected item}",
                                                                                "NavigationSelect":  {

                                                                                                     }
                                                                            }
                                                               }
                                         },
                                         {
                                             "Id":  "NumberTileListBuilderBlade",
                                             "Type":  "Blade",
                                             "Version":  0,
                                             "Configuration":  {
                                                                   "General":  {
                                                                                   "title":  "Desktop Groups",
                                                                                   "newGroup":  false,
                                                                                   "icon":  "",
                                                                                   "useIcon":  false
                                                                               },
                                                                   "Tile":  {
                                                                                "Query":  "ITPC_CTX_PerfData_CL | distinct Worker_s\r\n| count // Oql: Type=ITPC_CTX_PerfData_CL | distinct Worker_s",
                                                                                "Legend":  "Worker Count",
                                                                                "NavigationSelect":  {

                                                                                                     }
                                                                            },
                                                                   "List":  {
                                                                                "Query":  "ITPC_CTX_PerfData_CL | summarize AggregatedValue = dcount(Worker_s) by DesktopGroup_s\r\n// Oql: Type=ITPC_CTX_PerfData_CL|measure countdistinct(Worker_s) by DesktopGroup_s",
                                                                                "HideGraph":  false,
                                                                                "enableSparklines":  true,
                                                                                "operation":  "Summary",
                                                                                "ColumnsTitle":  {
                                                                                                     "Name":  "DesktopGroup",
                                                                                                     "Value":  "#"
                                                                                                 },
                                                                                "Color":  "#0072c6",
                                                                                "thresholds":  {
                                                                                                   "isEnabled":  false,
                                                                                                   "values":  [
                                                                                                                  {
                                                                                                                      "name":  "Normal",
                                                                                                                      "threshold":  "Default",
                                                                                                                      "color":  "#009e49",
                                                                                                                      "isDefault":  true
                                                                                                                  },
                                                                                                                  {
                                                                                                                      "name":  "Warning",
                                                                                                                      "threshold":  "60",
                                                                                                                      "color":  "#fcd116",
                                                                                                                      "isDefault":  false
                                                                                                                  },
                                                                                                                  {
                                                                                                                      "name":  "Error",
                                                                                                                      "threshold":  "90",
                                                                                                                      "color":  "#ba141a",
                                                                                                                      "isDefault":  false
                                                                                                                  }
                                                                                                              ]
                                                                                               },
                                                                                "NameDSVSeparator":  "",
                                                                                "NavigationQuery":  "search {selected item}\r\n// Oql: {selected item}",
                                                                                "NavigationSelect":  {

                                                                                                     }
                                                                            }
                                                               }
                                         }
                                     ],
                       "Filters":  [

                                   ],
                       "OverviewTile":  {
                                            "Id":  "SingleNumberBuilderTile",
                                            "Type":  "OverviewTile",
                                            "Version":  2,
                                            "Configuration":  {
                                                                  "Tile":  {
                                                                               "Legend":  "Are reporting to Log Analytics",
                                                                               "Query":  "ITPC_CTX_PerfData_CL | where TimeGenerated \u003e ago(30m) | distinct Worker_s\r\n| count // Oql: Type=ITPC_CTX_PerfData_CL TimeGenerated\u003eNOW-30MINUTES | distinct Worker_s"
                                                                           },
                                                                  "Advanced":  {
                                                                                   "DataFlowVerification":  {
                                                                                                                "Enabled":  true,
                                                                                                                "Query":  "Type=ITPC_CTX_PerfData_CL | measure count() ",
                                                                                                                "Message":  "There are no data know. Make sure that you have installed the agents (http://loganalytics.sepago.com).\n\nKeep in mind that after the first time data arrived to Log Analytics it takes some time (up to hours) to build the data scheme. "
                                                                                                            }
                                                                               }
                                                              }
                                        }
                   }
}
          ]
        }
    ]
}
